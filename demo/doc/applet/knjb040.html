<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<META name="GENERATOR" content="IBM WebSphere Studio Homepage Builder Version 8.0.2.0 for Windows">
<META http-equiv="Content-Style-Type" content="text/css">
<TITLE></TITLE>
<STYLE type="text/css">
<!--
@import url(default.ja.css);
-->
</STYLE>
</HEAD>
<BODY>
<H1>時間割作成(KNJB040)</H1>
<H2>「基本時間割」、「通常時間割」を作成する。時間割作成とは授業（以降、「コマ」と呼ぶ）を時間割表に割当てる事である。<BR>
授業は「HR」と「同時展開」の２つに大別され、各々、「TT」、「連続授業」などの属性を持っている。</H2>

<TABLE border="1">
  <CAPTION>パラメータ</CAPTION>
  <TBODY>
    <TR>
      <TD>職員コード</TD>
      <TD>staffcd</TD>
      <TD>999999</TD>
    </TR>
    <TR>
      <TD>DB名</TD>
      <TD>dbname</TD>
      <TD><BR>
      </TD>
    </TR>
  </TBODY>
</TABLE>
<H3>主な関連テーブル</H3>
<UL type="circle">
  <LI>sch_ptrn_dat
  <LI>sch_ptrn_hdat
  <LI>sch_chr_dat
  <LI>chair_dat
  <LI>chair_set_dat
  <LI>sch_fac_dat
  <LI>chair_fac_dat
  <LI>staff_ydat
  <LI>staff_mst
  <LI>section_ydat
  <LI>section_mst
  <LI>electclass_rela_dat: 選択群親子データ
</UL>
<H3>その他</H3>
<UL>
  <LI>次のフェーズ対応（作成支援）
  <UL>
    <LI>自動コマ割り
    <LI>CSV取り込み
  </UL>
  <LI>「基本」から「通常」画面に遷移した際は、システム日付をデフォルトとする。
  <LI>TTの授業に対応している。
  <LI>連続授業に対応している。
  <LI>DBに接続するID、パスワードやリンク先URLなどは properties ファイルに持つ。
</UL>
<HR>
<H3>◎共通</H3>
<H4>メニューバー</H4>
<TABLE border="1">
  <TBODY>
    <TR>
      <TD align="center"><B>ファイル(F)</B></TD>
      <TD align="center"><B>編集(E)</B></TD>
      <TD align="center"><B>ツール(T)</B></TD>
      <TD align="center"><B>ウィンドウ(W)</B></TD>
      <TD align="center"><B>情報(I)</B></TD>
    </TR>
    <TR>
      <TD>保存(S)</TD>
      <TD>全てクリア(Clear)</TD>
      <TD>自動コマ割り(Auto)</TD>
      <TD>名簿入力(M)</TD>
      <TD>時間割作成について．．．(About)</TD>
    </TR>
    <TR>
      <TD>名前を付けて保存（新規）(A)</TD>
      <TD>割り当て(Assign)</TD>
      <TD>CSV取込み(C)</TD>
      <TD>ＨＲ別時間割確認(H)</TD>
      <TD><BR>
      </TD>
    </TR>
    <TR>
      <TD>終了(X)</TD>
      <TD>削除(Delete)</TD>
      <TD><BR>
      </TD>
      <TD>施設別時間割確認(S)</TD>
      <TD><BR>
      </TD>
    </TR>
    <TR>
      <TD><BR>
      </TD>
      <TD>入れ替え（移動）(Swap)</TD>
      <TD><BR>
      </TD>
      <TD>時間割反映(J)</TD>
      <TD><BR>
      </TD>
    </TR>
    <TR>
      <TD><BR>
      </TD>
      <TD>取消(U)</TD>
      <TD><BR>
      </TD>
      <TD><BR>
      </TD>
      <TD><BR>
      </TD>
    </TR>
  </TBODY>
</TABLE>
<DL>
  <DT>保存
  <DD>編集中の時間割を保存する。
  <DT>名前を付けて保存
  <DD>基本時間割の時に使う。詳細は後述している。
  <DT>終了
  <DD>時間割作成の終了
  <DT>全てクリア
  <DD>時間割の全講座を削除する
  <DT>割り当て
  <DD>選択されているセルに、選択されている講座（または群）を割り当てる
  <DT>削除
  <DD>選択されているセルの講座を削除する
  <DT>入れ替え
  <DD>？？？？オペレーション不可？？？
  <DT>取消
  <DD>直前の状態に戻る
  <DT>自動コマ割り
  <DD>保留
  <DT>ＣＳＶ取込み
  <DD>保留
  </DL>
<H4>ヘッダーエリア</H4>
<H4>メインエリア</H4>
<UL>
  <LI>月曜日からの先頭１週間表示固定とする。が初期表示は指定した日付もしくは指定した曜日を表示する。
  <LI>右クリックするとコンテキストメニュー（ポップアップ）を表示。
  <LI>左クリックでセルを選択状態にする。
  <LI>「割当済み校時数」欄には、その行の割当たっている授業の合計を表示
  <LI>教師が稼動できない校時のマスは色などでわかるようにする。講座の割当は可能。
  <LI>同時展開は若い年組を表示し、その後ろに同時展開マーク、「＊」を付ける。
  ⇒例） &quot;1-1*&quot;
  <LI>HRタブの場合、所属でグループ化し、年度の教師(正担任のみ)を表示する。
  <LI>同時展開タブの場合、メインエリアでの教師、タブエリアでの群に属する教師のみを表示する。
  <LI>連続授業を割り当てたい場合は、隣接する校時に対してオペレータが同講座を割り当てる。結果、連続授業になったということで、時間割プログラム上では割当に対する連続か単一かの区別はしない。
  <LI>セル上で右クリック
  <UL>
    <LI><B>[割当]</B><BR>
    タブで選択されている講座（または群）がセルに割り当てられる。
    <UL>
      <LI>既に講座がある場合はエラー　（それとも[割当]を選択不可にする？）<BR>
      （その講座を移動などして割り当てさせる）
      <LI>TTで他の教師が、その校時に割り当てられない状態（他の授業割り当て済み）ならエラー。
      <LI>講座が割当数に足りない、または超えていても割り当て可<BR>
      （チェックリスト対象）
      <LI>教師の稼働時間を超えている場合でも割り当て可（チェックリスト対象）
    </UL>
    <LI><B>[削除]</B><BR>
    セル上にある講座が削除される。<BR>
    空白セルでは選択不可。
    <LI><B>[入れ替え（移動）]</B><BR>
    選択されたセルとマウスポインタ上にあるセルを入れ替える。この機能は同一行に対してのみ有効<BR>
    片方が空白セルなら移動という事になる。
    <LI><B>[プロパティ]</B><BR>
    選択されている講座（セル）のプロパティをダイアログ表示する。空白セルでは選択不可。<BR>
    同時展開授業の場合、群名称も表示する。
  </UL>
</UL>
<H5>セルの状態の表現</H5>
<TABLE border="1">
  <CAPTION>背景色のパターン</CAPTION>
  <TBODY>
    <TR>
      <TH>状態</TH>
      <TH>前景／背景</TH>
      <TH>色</TH>
      <TH>備考</TH>
    </TR>
    <TR>
      <TD>セルの選択状態</TD>
      <TD>背景</TD>
      <TD>紫</TD>
      <TD>Javaのデフォルトがこうなっている</TD>
    </TR>
    <TR>
      <TD>編集したマーク</TD>
      <TD>背景</TD>
      <TD>黄色</TD>
      <TD>保存が押されるまでに、いじったセル</TD>
    </TR>
    <TR>
      <TD>データ区分</TD>
      <TD>背景</TD>
      <TD>グレー</TD>
      <TD>過去に変更された、または削除されたセル</TD>
    </TR>
    <TR>
      <TD>教師稼動不可</TD>
      <TD>背景</TD>
      <TD>赤</TD>
      <TD></TD>
    </TR>
  </TBODY>
</TABLE>
<P>※状態は上に行くほど強い。すなわち、「教師稼動不可かつ、データ区分が立っているマス」は背景色がグレーとなる。</P>
<TABLE border="1">
  <CAPTION>文字色のパターン</CAPTION>
  <TBODY>
    <TR>
      <TH>状態</TH>
      <TH>前景／背景</TH>
      <TH>色</TH>
      <TH>備考</TH>
    </TR>
    <TR>
      <TD>出欠済み</TD>
      <TD>前景</TD>
      <TD>青</TD>
      <TD></TD>
    </TR>
  </TBODY>
</TABLE>
<P></P>
<H4>タブエリア</H4>
<BLOCKQUOTE>「HR」、「同時展開」のタブが存在する。<BR>
講座（または群）のダブルクリックでメインエリアの選択セルに割り当てられる。</BLOCKQUOTE>
<UL>
  <LI>HRタブ
  <UL>
    <LI>上部に教師の持っている講座の一覧を表示する。下部にはその選択されている講座のプロパティが表示される。
    <LI>上部に表示する項目
    <UL>
      <LI>講座名称
      <LI>講座コード
      <LI>割当／合計
      <LI>ＴＴ
      <LI>連続授業
    </UL>
    <LI>下部に表示する項目
    <UL>
      <LI>連続授業数
      <LI>施設（１つのはず）
      <LI>ＴＴ（複数の教師が表示される）
    </UL>
  </UL>
  <LI>同時展開タブ
  <UL>
    <LI>全ての群の一覧を表示する。下部にはその選択されている群のプロパティが表示される。
    <LI>上部に表示する項目<BR>
    (選択群親子データから引っ張ってくる。全レコードでよい)
    <UL>
      <LI>群コード（入れ子の場合、親群コードと子群コードをハイフンで連結。例）9999-1234）
      <LI>群名称（入れ子の場合、親と子の名称をハイフンで連結）
      <LI>連続授業（ぶら下がる講座が１つでも連続ならＯＮ（１つの講座が連続なら他も連続でしょう））
    </UL>
    <LI>下部に表示する項目
    <UL>
      <LI>連続授業数
      <LI>施設（複数の場合あり）
    </UL>
  </UL>
</UL>
<H4>プロパティエリア</H4>
<BLOCKQUOTE>タブエリアの下に常に表示される。メインエリアで選択されているセルのプロパティを表示する。</BLOCKQUOTE>
<HR>
<H3>◎基本</H3>
<H4>ヘッダーエリア</H4>
<UL>
  <LI>「SEQ:タイトル」コンボボックスより既存の基本時間割を読み込むことが出来る<BR>
  編集中の時にコンボを変更されるとワーニングダイアログを表示。
  <LI>SEQは年度ごとに１から始まり、自動採番である。
  <LI>「名前を付けて保存」で新規に基本時間割を作成することが出来る。<BR>
  ダイアログを表示し、「年度」・「学期」・「タイトル」を入力させる。
  <UL>
    <LI>講座が設定されている場合、「年度」・「学期」が講座データに存在すれば、コピーする。<BR>
    存在しない講座があれば、メッセージを表示し、コピーの対象から除外される。
    <LI>空白の新規をしたい場合、オペレータは事前に「全てクリア」していればよい。
  </UL>
</UL>
<H4>メインエリア</H4>
<UL>
  <LI>
</UL>
<H4>タブエリア</H4>
<BLOCKQUOTE>講座（または群）のダブルクリックでメインエリアの選択セルに割り当てられる。</BLOCKQUOTE>
<UL>
  <LI>HRタブ
  <UL>
    <LI>上部に教師の持っている講座の一覧を表示する。下部にはその選択されている講座のプロパティが表示される。
  </UL>
  <LI>同時展開タブ
  <UL>
    <LI>全ての群の一覧を表示する。下部にはその選択されている群のプロパティが表示される。
  </UL>
</UL>
<P><IMG src="knjb040/jikanwari_image2.jpg" width="953" height="503" border="0"></P>
<HR>
<H3>◎通常</H3>
<UL>
  <LI>指定された日の週を月曜日から日曜日まで表示する。
</UL>
<H4>ヘッダーエリア</H4>
<UL>
  <LI>実施期間の開始ボタンは指定の日を表示し、終了のテキストフィールドはその週の最後（日曜日）が表示される。
</UL>
<H4>メインエリア</H4>
<UL>
  <LI>既に割り当てられている講座（DBに登録されている講座）を「削除」または「他の講座に置き換え」た場合は、[時間割講座データ．データ区分]フラグを立てる。フラグが立っている状態をオペレータがわかるようにする（色分けできれば良いが・・・）
  <LI>[時間割講座データ．出欠フラグ]が立っている講座は編集の対象外となる。セル上では文字色などを変えるなどする。<BR>
  同時展開講座の場合は関連する他の講座を含めて１つでも立っていれば、その群全体が対象となる。
  <LI>削除された講座の講座コードは０
</UL>
<H4>タブエリア</H4>

  <P><IMG src="knjb040/jikanwari_image1.jpg" width="1126" height="594" border="0"></P>
</BODY>
</HTML>

-- kanji=漢字
-- 実行前にDROP FUNCTION SECURITY_CHK_MNU、SECURITY_CHK_MNU2、SECURITY_CHK_PRG実行し、再度FUNCTIONのSCRIPTを実行する必要あり

DROP TABLE MENU_SUB_MST_OLD
RENAME TABLE MENU_SUB_MST TO MENU_SUB_MST_OLD
CREATE TABLE MENU_SUB_MST \
    (SCHOOLCD        VARCHAR(12) NOT NULL, \
     SCHOOL_KIND     VARCHAR(2)  NOT NULL, \
     SUBID           VARCHAR(11) NOT NULL, \
     SUBSUBID        VARCHAR(2), \
     PARENTSUBID     VARCHAR(11), \
     SUBNAME         VARCHAR(120), \
     SUBNAME_ENG     VARCHAR(120), \
     MAINID          VARCHAR(11), \
     SYORI_MONTH     INT, \
     HIDE_FLG        varchar(1), \
     REGISTERCD      VARCHAR(10), \
     UPDATED         TIMESTAMP DEFAULT CURRENT TIMESTAMP \
) IN USR1DMS INDEX IN IDX1DMS

ALTER TABLE MENU_SUB_MST ADD CONSTRAINT PK_MENU_SUB_MST PRIMARY KEY (SCHOOLCD, SCHOOL_KIND, SUBID)

INSERT INTO MENU_SUB_MST \
    SELECT \
        SCHOOLCD, \
        SCHOOL_KIND, \
        SUBID, \
        SUBSUBID, \
        PARENTSUBID, \
        SUBNAME, \
        SUBNAME, \
        MAINID, \
        SYORI_MONTH, \
        HIDE_FLG, \
        REGISTERCD, \
        UPDATED \
    FROM \
        MENU_SUB_MST_OLD

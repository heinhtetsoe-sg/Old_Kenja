# kanji=漢字
# $Id: readme.txt 74894 2020-06-16 05:13:30Z arakaki $

2009/07/17  1.新規作成(処理：東京都KNJE010　レイアウト：東京都KNJE010参考)

2009/09/07  1.指定された生徒の学年により、中高を切り分ける。

2009/09/25  1.TRAIN_REF1フィールド、追加に伴う修正
            -- rep-hexam_entremark_dat.sql-1.4
            -- rep-grd_hexam_entremark_dat.sql-1.2
            3.更新でTRAIN_REFが消えてしまうバグを修正

2009/10/23  1.鳥取の時の入力可能な桁数を変更

2009/10/26  1.出欠の備考を５行→６行に変更した。

2009/10/28  1.「特別活動の記録」の入力可能なサイズを「prgInfo.properties」のフラグで変えるよう修正

2009/10/30  1.「指導上参考となる諸事項」は「prgInfo.properties」の
              「tyousasyoTokuBetuFieldSize」が「1」の時 5行 ⇒ 7行
            2.「総合的な学習・評価」の行数を修正 4行 ⇒ 5行

2009/11/05  1.「指導上参考となる諸事項」は「prgInfo.properties」の
              「tyousasyoTokuBetuFieldSize」が「1」の時 41文字 ⇒ 58文字

2009/11/11  1.部活動参照ボタン、委員会参照ボタン、資格参照ボタンを追加

2009/12/10  1.prgInfo.properties の useQualifiedMstで資格参照の表示を切り替える処理追加

2010/02/23  1.「通知票より読込」ボタン追加、エラーの文字数チェックを行数チェックに変更
            2.「総合学習評価」のサイズは prgInfo.properties の tyousasyoSougouHyoukaFieldSize を参照するよう修正

2010/03/17  1.「出欠備考参照」ボタンのパラメータに開始日付、終了日付を追加した。

2010/03/24  1.getPropertiesAll()を使うよう修正
            2.「出欠の記録備考」の文字数、行数はプロパティーファイルで指定できるよう修正
            --「指導上参考となる諸事項」ボタン追加

2010/03/30  1.「通知票より読込」ボタンを隠した

2010/04/05  1.部活動参照、委員会参照画面の出席番号をカットして、学籍番号を表示した。

2010/04/22  1.「availheight」を「availHeight」に修正

2010/05/27  1.表示文字修正「学習指導要録より読込」⇒「生徒指導要録より読込」

2010/06/08  1.以下を修正
            -- 「活動内容」はプロパティーファイルの「tyousasyoTotalstudyactFieldSize」を参照するよう修正
            -- 「評価」    はプロパティーファイルの「tyousasyoTotalstudyvalFieldSize」を参照するよう修正
            -- KNJE010Bで使わなくなったプロパティー 「tyousasyoSougouHyoukaFieldSize」

2010/06/24  1.最初に開いたとき学年のデータがなく右フレームの
            --テキストボックスが表示できないため、
            --学年データがない場合は左フレームの「年組」コンボボックスより
            --より学年データを取得するよう修正

2010/07/17  1.3分割の桁数をプロパティーファイルで変更できるよう修正

2010/07/20  1.CSVの権限チェックに対応

2010/07/27  1.「出欠の記録備考」「活動内容」「評価」のサイズの初期値修正

2010/07/28  1.CSV処理の「卒業生」に対応

2010/08/16  1.「調査書旧データ」を追加

2010/08/19  1.SQLの不具合修正

2010/08/20  1.SQL中の年度の修正

2010/08/25  1.「指導上参考となる諸事項」3分割の際の初期値の修正
            2.「指導上参考となる諸事項」3分割の際の行の初期値の修正

2010/09/07  1.「指導上参考となる諸事項」エラーの後、左のテキストエリアが空になる不具合を修正した。

2010/09/30  1.「貼付け」機能を修正した。(キャンセルで普通の貼付け)

2011/03/02  1.委員会参照画面に学期を追加した。

2011/03/25  1.総合的な学習の時間の内容・評価、備考に追加・挿入の貼り付けをできるようにした。

2011/03/29  1.年度データ参照の指導要録参照画面を追加した。
            2.プロパティー「sidouyourokuSansyou」で指導要録参照画面（通年・年度）を切り替えるように修正した。

2011/04/12  1.文字数チェックをバイトチェックに変更した。

2011/04/28  1.以下の修正をした
            -- 権限渡し
            -- エクセル出力ボタン表示有無
            -- MENU_HIGH_SECURITY_MSTのPROGRAMIDがある場合、PROGRAMPATHを参照する。
            -- KNJXEXPへ渡すパラメータ(SEND_AUTH)を追加。
            
2011/07/20  1.loadwindowの呼び出し位置を修正

2011/08/11  1.プロパティー「tyousasyoSpecialactrecFieldSize」で特別活動の記録のサイズを変更するように修正した。

2011/08/23  1.指導要録参照画面（年度）の学年コンボのSQLを変更した。
            2.指導要録参照画面（通年）の文字数を変更した。
            
2011/11/16  1.教育課程の追加、追加に伴う修正
                - Properties["useCurriculumcd"]=1のときのみ、教育課程処理に対応

2013/01/11  1.CLASS_MSTテーブルのCURRICULUM_CDをカット

2013/06/20  1.出欠備考参照ボタンの参照先を切替処理追加
                - Properties["useAttendSemesRemarkDat"]の値により切替を行う
                
2013/06/25  1.出欠備考参照ボタンの表示名を修正
                - Properties["useAttendSemesRemarkDat"] = 1の時、まとめ出欠備考参照
                - それ以外、日々出欠備考参照

2013/07/04  1.部活動参照ボタンの位置を変更した。

2013/08/14  1.指導上参考となる諸事項の3分割の各項目はProperties["train_ref_1_2_3_field_size"] = 2の時、21文字/21文字/7文字までとなるように修正

2013/08/21  1.帳票が禁則処理を設定している場合、所見にスペースにつづいて長音（ー）を含むかチェックする処理を追加

2013/09/09  1.８．総合的な学習欄
            - Properties["tyousasyoSougouHyoukaNentani"]の値により通年・年度を切り替える

2013/09/10  1.プロパティuseTorikomiAttendSemesRemarkDat = 1の時（#useAttendSemesRemarkDat = 1の時のみ設定有効）
              - まとめ出欠備考参照 ⇒ まとめ出欠備考取込に変更
              
2013/09/11  1.プロパティuseTorikomiAttendSemesRemarkDat = 1の時のまとめ出欠備考取込の仕様を修正
                - 取込データがない場合は、空白とする
            2.備考に「特記事項なし」チェックボックスを追加

2013/10/16  1.常磐仕様の時、生徒指導要録より読込み時にHTRAINREMARK_DETAIL_DATのテーブルよりTRAIN_REF1,2,3のフィールド値を取得し、指導上参考となる諸事項の3分割の各項目にセットするよう修正

2013/10/17  1.総合的な学習欄が通年の時、生徒指導要録より読込み時に「8.総合的な学習の時間の内容・評価」を生徒指導要録から画面の項目に表示
            2.生徒指導要録より読込みの年度コンボの初期値に、ログイン年度をセットするよう修正
            3.【指導上参考となる諸事項】のボタンを、調査書旧データの横に移動
            4.総合的な学習欄が通年の時、生徒指導要録より読込み時の参照先をProperties["sidouyourokuSansyou"]の値により切替
            
2013/10/25  1.常磐仕様の時、生徒指導要録より読込み時にHTRAINREMARK_DETAIL_DATのテーブルよりTRAIN_REF1,2,3のフィールド値を取得する対象を修正
               - 2012年より前は対象外
               - 2013年は2年次以上を対象外
               - 2014年は3年次を対象外
               - 2015年以降は全てを対象とする
               
2013/10/29  1.生徒指導要録から読込ボタンの色を変更

2014/02/07  1.まとめ出欠備考取込の各学年のボタン押下時、対応する学年のみの取り込みを行うよう修正

2014/03/06  1.更新時のロック機能(レイヤ)を追加

2014/03/11  1.更新時のロック機能(レイヤ)修正漏れ対応

2014/03/22  1.tyousasyoShokenPreviewが'1'の場合、調査書所見プレビューボタンを表示
            2.ボタン不足を追加

2014/03/28  1.更新時のロック機能(レイヤ)修正

2014/04/21  1.更新時のロック機能(レイヤ)はプロパティ「useFrameLock」= '1'の時、有効
            2.貼り付け機能の修正
                - 関数名を修正 show ⇒ showPaste

2014/05/13  1.Properties["train_ref_1_2_3_field_size"]を'-'区切りで設定できるよう修正（指導上参考となる諸事項の3分割の各項目）

2014/06/02  1.更新/削除等のログ取得機能を追加

2014/07/31  1.更新後前・次の生徒へボタン押下後に一部が表示されない不具合を修正

2015/02/19  1.生徒指導要録より読込ボタンは教務主任等マスタのPOSITIONCD='0100'が設定されている職員は使用不可となるよう修正

2015/02/20  1.プロパティ「useSyojikou3_torikomi」= '1'のとき、指導上参考データ３分割の指導要録取込みを行うよう修正(常盤以外)
            
2015/02/26  1.学年(KNJA023のNAMESPARE2,3にて判断)により下記のボタンを追加および修正
              - 1,2年次のみ指導要録より読込ボタンを表示するよう修正
              - 3年次は通知票取込ボタンを追加

2015/02/27  1.指導要録より読込ボタンを元に戻した
            2.総合的な学習の時間の項目に学年(KNJA023のNAMESPARE2,3にて判断)により下記のボタンを追加および修正
               - 通年のとき1,2年次は指導要録取込ボタンを追加
               - 通年のとき3年次は通知票取込ボタンを追加
               - 年単位のとき指導要録・通知票取込ボタンを追加
            3.ボタンレイアウト修正
            
2015/03/02  1.各項目の学年タイトルの帯の後に年度を表示するよう修正
            2.総合的な学習の時間の項目の学年の判断を修正
               - KNJA023のNAMESPARE2,3にて判断 ⇒ SCHREG_REGD_GDATのGRADE_CDにより判断

2015/03/27  1.京都仕様(名称マスタZ010のNAME1で判断)の場合、総合的な学習の時間の活動内容と評価は入力不可とする。
               - ただし、取込更新は可

2015/06/09  1.肩書き3の追加に伴う生徒指導要録より読込ボタンは教務主任等マスタのPOSITIONCD='0100'が設定されている職員は使用不可の追加修正
               - STAFF_SEQ = '007'のときも条件に追加
               
2015/06/19  1.海城学園は生徒指導要録より読込ボタンを非表示にするよう修正

2015/07/23  1.年単位の時、ボタン表示のプロパティが誤っていたため、修正
                - 1,2年次　　　指導要録取込⇒プロパティ「tyousasyo_SidoYorokYoriYomikomiHyoujiFlg」= '1'
                - 3年次以上　　通知票取込⇒プロパティ「tutihyoYoriYomikomiHyoujiFlg」= '1'
            2.通年の時、通知票取込のボタン表示の3年次をGRADE_CD='3'で判断していたが、3年次以上で判断するよう修正
            
2015/07/24  1.京都の中でプロパティ「kyotoSougouNyuryokuOk」 = "1"が立っている所は総合的な学習の時間を入力可とする
            
2015/07/27  1.京都の８．総合的な学習の時間の内容・評価の年度ごとの取り込みボタンで７．指導上参考となる諸事項がクリアされないように修正

2015/07/28  1.通年の時総合的な学習の時間の内容・評価の通知票取込のボタンを押下した場合、入力値の後に改行して取り込むよう修正

2015/08/10  1.年単位の時、1,2年次　指導要録取込、3年次　通知書取込(総合的な学習の時間)ボタンの表示を修正
                - プロパティ、学年の条件を満たさない場合はボタンを表示しないよう修正
                
2015/08/11  1.取り消しボタン押下時に出欠の記録備考も元に戻すよう修正

2015/12/17  1.更新時は更新ボタンを押下できないよう修正した

2016/03/17  1.記録備考参照ボタン追加
            -- プロパティ「club_kirokubikou」が"1"のとき、表示する。

2016/05/10  1.学習成績概評○囲み表示チェックボックス
            -- プロパティ「useMaruA_avg」の設定があれば非表示。

2016/06/17  1.調査書旧データをカット
            2.ボタンの文言を「記録備考参照」→「大会記録備考参照」に変更

2016/07/25  1.濱崎さんが文京本番機で修正した内容を組み込み
            -- 文京の場合も3分割の諸事項取り込むよう修正
            
2016/08/04  1.PHP5.6対応のための修正
                - 関数呼び出し時の&$を修正

2016/08/08  1.通知票取込ボタン追加
            -- 三重県のとき、出欠備考参照ボタンを通知票取込ボタンに切り替える

2016/08/09  1.固定文言「学習成績概評○囲み表示」→「学習成績概評のマルＡ表示有」変更
            2.部活参照画面に備考表示追加
            3.資格参照画面でプロパティー「useQualifiedMst」が'1'のときに略称表示追加

2016/09/21  1.校種条件追加
            -- プロパティー「useSchool_KindField」とSCHOOLKINDを参照
            2.校種条件追加

2016/09/26  1.委員会参照、部活動参照、大会記録備考参照修正
            -- プロパティー「useSchool_KindField」とSCHOOLKINDを参照

2016/09/27  1.９．備考の文字、桁数のプロパティーtyousasyoRemarkFieldSize追加

2017/05/30  1.出欠の記録参照ボタン追加
            -- プロパティー「tyousasyoSyukketsuKirokuBtn」が'1'のとき表示

2017/06/07  1.出欠の記録参照画面を修正
            -- 遅刻・早退取込ボタンを取込ボタンに変更
            -- 欠席、遅刻、早退にチェックボックス追加（取込対象項目選択）

2017/06/14  1.前回の修正もれ
            -- IE11未満の対応

2017/06/20  1.以下の不具合を修正
            1)４学年の指導要録より取込みを実行
            2)５学年の指導要録より取込みを実行
            ４年の内容が消える。
            通知票取込みを押すと、上記内容がすべて消える。

2017/07/20  1.学校マスタ情報取得するとき、SCHOOLCD、SCHOOLKINDを渡すよう修正
            -- AttendAccumulate.php(1.7)に伴う修正

2017/07/25  1.「資格参照」に、"主催"を追加
            2.帳票パラメーター追加。gaihyouGakkaBetu

2017/08/01  1.各参照ボタンで、日付の和暦表示切替処理追加
            --プロパティ useWarekiHyoji = 1 の時、和暦で表示する

2017/08/29  1.出欠の記録参照(subForm9.php)で、項目 "停止・忌引" を "停止" と "忌引" に分割し
            --それぞれにチェックボックス追加
            2.文言修正 "停止" → "出席停止"

2017/09/06  1.日々出欠備考参照ボタンの切り替え条件を修正

2017/09/14  1.ADMIN_CONTROL_PRG_SCHOOLKIND_MSTを使って、校種を制御する。
            --プロパティー追加：use_prg_schoolkind

2017/09/22  1.文言修正 "学習成績概評のマルＡ表示有" → "学習成績概評のマルＡ表示対象者"

2017/10/06  1.表彰参照ボタン追加、プロパティー「useHyosyoSansyoButton_H」が"1"の時表示

2017/12/04  1.参照ボタンを選択ボタンに変更
            -- 委員会、部活動、記録備考、検定、賞
            -- 選択したデータ、項目の取込機能追加
            2.部活動選択ボタンを特別活動の記録欄に追加
            3.部活動、記録備考、検定、賞選択ボタンを各学年（年度）に配置
            -- 該当年度のデータのみ一覧に表示する

2017/12/05  1.総合的な学習の時間のレイアウト変更
            -- プロパティー「tyousasyoSougouHyoukaNentani」が'1'のときのみ

2018/02/06  1.出欠の記録備考に特記事項なしチェックボックス追加

2018/03/08  1.賞選択画面の表示内容変更
            -- 常盤木のとき、活動の記録(4)を表示

2018/03/16  1.検定選択画面でSUBCLASS_QUALIFIED_TEST_DATのデータも表示
            -- プロパティー「useQualifiedMst」かつプロパティー「useSchregQualified」が'SUBCLASS_QUALIFIED_TEST_DAT'の時

2018/04/27  1.総合的な学習の時間（内容・評価）に斜線を入れるチェックボックス追加
            -- プロパティー「useTotalstudySlashFlg」が'1'のとき表示

2018/04/30  1.出欠備考に斜線を入れるチェックボックス追加
            -- プロパティー「useAttendrecRemarkSlashFlg」が'1'のとき表示

2018/06/12  1.７．指導上参考となる諸事項の枠のサイズを「seitoSidoYoroku_dat_TotalremarkSize」によって切替える。
            2.変数名修正

2018/06/18  1.プロパティーuseMaruA_avgが設定された場合「学習成績概評のマルＡ評定平均値 X.X」を表示
            2.学習成績概評のチェックボックス、文言を備考の下に移動

2018/06/19  1.useTotalstudySlashFlgプロパティーをセットした際のDBエラー修正

2018/07/11  1.部活動選択ボタン先でのリスト条件変更、指定年度が開始日と終了日間でれば表示する。

2018/10/16  1.部活動複数校種設定対応
            -- プロパティー「useClubMultiSchoolKind」参照

2018/12/26  1.共通プログラムに変更
            -- 委員会選択、賞選択、部活動選択、記録備考選択、検定選択

2019/02/13  1.左画面へのパラメーター追加(校種縛り)

2019/05/23  1.留年の判定にログイン年度以下の条件を追加

2019/05/27  1.処理時間改善(前回のSQL修正)

2019/06/25  1.プロパティーtyousasyoSougouHyoukaNentaniPrintCombined追加

2019/07/04  1.「年間出欠備考選択」ボタンを追加
            -- プロパティー「useReasonCollectionBtn」が'1'のとき表示

2019/07/19  1.DB接続を修正

2019/08/01  1.更新対象外の項目が削除される処理の修正
            -- HEXAM_ENTREMARK_HDAT.REMARK2
            -- GRD_HEXAM_ENTREMARK_HDATREMARK2

2019/09/19  1.「出欠の記録参照」は「KNJX_SYUKKETSUKIROKU」を呼び出すよう修正

2019/09/20  1.対象学年のみ更新に変更

2020/01/14  1.特別活動のデフォルト印刷用の文字数プロパティtyousasyoSpecialactrecFieldSizeDefaultPrintが設定されておりデータの行数がこの指定を超えていた場合更新注意メッセージを表示する

2020/01/30  1.プロパティtyousasyo2020が1の場合、調査書A4フォームへの変更にともなう修正
            ・指導上参考となる諸事項6分割はHEXAM_ENTREMARK_TRAINREF_DAT(TRAIN_SEQ 101～106)を使用する
            ・備考はHEXAM_ENTREMARK_REMARK_HDATを使用する
            ・項目の番号と表示順変更
            ・指導上参考となる諸事項、備考の参照画面追加.

2020/02/03  1.2020/01/30修正分をカット（別IDのKNJE010Dで作成する）

2020/02/05  1.ボタン名称変更
            --【プレビュー／印刷】→【確認用所見印刷】

2020/02/07  1.ボタン名称変更
            --【確認用所見印刷】→【所見確認用】

2020/05/20  1.選択年度が「全て」の場合、全年度分取得を在籍している年度分取得するよう修正
            --「生徒指導要録より読込」ボタン押下時

2020/05/29  1.「生徒指導要録より読込」押下時に確認ダイアログを追加
             -- 「OK」押下時は上書き読込、「キャンセル」押下時は追加読込
            2.選択年度が「全て」の場合、「生徒指導要録より読込」処理は年度の昇順で読込むように修正

2020/06/01  1.「生徒指導要録より読込」確認ダイアログ追加時の修正漏れを修正

2020/06/16  1.KNJE070で使用しているプロパティを追加
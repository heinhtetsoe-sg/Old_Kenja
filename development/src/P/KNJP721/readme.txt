# kanji=漢字
# $Id: 8f6a73ddbc717812992d33a4891a06f8c1908a00 $

2018/03/09  1.新規作成

2018/03/13  1.減免処理修正
            2.補助金修正
            3.名称マスタ年度参照

2018/03/21  1.以下の修正をした。
            -- 減免先データの判定修正
            -- 前期加算のPOSTが抜けていた
            2.負担金・調整金修正
            3.補助金計算式修正
            4.補助金計算式修正

2018/03/29  1.REDUCTION_COUNTRY_ADD_MST廃止、REDUCTION_COUNTRY_MSTにフィールド追加
            -- rep-reduction_country_mst.sql

2018/03/30  1.REDUCTION_AUTHORIZE_DATカット、sql修正

2018/04/24  1.SEQ_1とSEQ_2の処理を修正
            2.前期ADD_DECISION_MONEYのクリア処理漏れ
            3.REDUCTION_COUNTRY_MSTにフィールド追加(2018/03/29)の修正漏れ

2018/06/07  1.IEでも画面リサイズが動作するよう修正

2018/08/07  1.固定文言修正。府県補助金 → 補助金
            2.補助金の計算ロジック修正
            3.割合と、絶対額でロジックを変える。

2018/12/17  1.今年度所得割額、前年度所得割額の隣に
            --保護者１、保護者２、保証人１、保証人２テキストボックスをそれぞれ追加

2018/12/18  1.補助金に保護者負担額の処理追加
            2.補助金の計算に標準授業料参照追加
            3.MEISYOU_GETをカットし、名称マスタから取得に変更

2018/12/20  1.減免の参照テーブル変更
            -- REDUCTION_SCHOOL_STD_DAT→SCHREG_SCHOLARSHIP_HIST_DAT
            2.月額計算→通年計算に変更
            3.phpでの不要な計算をカット

2018/12/25  1.2018/12/17の修正漏れ
            --文言変更「保護者１」、「保護者２」、「保証人１」、「保証人２」を
            --「市町村所得割１」、「都道府県所得割２」、「市町村所得割１」、「都道府県所得割２」に変更

2019/01/08  1.減免(先)がある場合、授業料、授業料等に差引後の値を表示
            2.負担金、調整金の計算ロジック変更
            3.減免の計算ロジック変更
            4.減免情報欄のリンク表示を変更
            5.修正漏れ

2019/01/23  1.所得割額の合計への反映は、母集団が全てブランクの場合、ブランクをセット

2019/01/25  1.支援金マスタにない場合のCOUNTRY_RANKが、Ajaxの結果にない時
            POSTする事が出来ず(undefinedをセットしたから？)、その為行がずれて
            下の生徒のRANKがセットされてしまう不具合対応。
            支援金マスタにない場合は、COUNTRY_RANK:''を返すように修正

2019/02/08  1.不要な処理をカット
            2.G216 → P711に変更

2019/03/01  1.負担金の計算ロジック変更
            2.調整金は計算ロジックが未定のため固定で0表示に変更
            3.複数伝票があり かつ 減免対象ではない生徒に「減」が表示される不具合修正
            4.所得割を空にしたのに計算されない不具合修正

2019/03/15  1.支援金、補助額のランクを変更したときも各金額をセットするよう変更
            2.再計算ボタン追加
            3.確定チェックされているとき、特殊フラグ、ランクを選択不可に変更
            4.新たに確定チェックしたとき、確定月の選択必須チェック追加
            5.下のほうに確定済みに関する文言追加
            6.更新後に補助額の特殊フラグが表示されない不具合修正

2019/03/27  1.再計算等での計算ロジック変更
            2.取消ボタンに確認メッセージ追加
            3.確定チェックの処理変更

2019/04/03  1.確定チェックの処理の修正漏れ

2019/04/08  1.SCHREG_SCHOLARSHIP_HIST_DATの変更に伴い修正
            2.補助額が絶対額のときの計算不具合修正
            3.補助額のランクをブランクにしたときは空表示に変更

2019/06/17  1.減免先があれば負担金に加算
            2.補助額があるとき、標準授業料との差額分は負担金に加算
            3.再計算の時、所得割額の有無参照
            4.負担金の参照・更新テーブル追加
            -- REDUCTION_SLIP_BURDEN_CHARGE_DAT
            5.入金項目マスタのフィールド名変更（IS_JUGYOURYOU→GAKUNOKIN_DIV）に伴い修正

2019/07/05  1.REDUCTION_BURDEN_CHARGE_PLAN_DATの処理追加
            2.負担金（前期・後期）の計算式追加
            3.減免額の計算を修正

2019/07/19  1.補助対象都道府県を固定で指定する処理追加
            -- プロパティー「reductionPrefCd」参照

2019/08/01  1.減免情報取得の対象条件追加
            -- REDUCTION_SCHOOL_LM_MST
            2.家族関連減免と学力等減免を併せて減免にまとめた
            3.REDUCTION_SCHOOL_PLAN_DATの更新処理変更
            4.支援金、補助金、減免対象項目と金額を分けるよう変更
            5.特待区分を取得するときの日付範囲の漏れ修正
            6.テーブルのキー追加・変更に伴い修正
            -- REDUCTION_TARGET
            7.支援、補助、学校負担、減免を支払月に合算する。

2019/08/02  1.標準授業料がNULLのときの条件追加

2019/08/11  1.各種PLANを作成する際の割る月数（回数）や寄せる処理を変更
            -- 支援金：確定月で寄せた後、支払い月で寄せる
            -- 補助金：前期を3、後期を9で割って月額を出し、確定月で寄せた後、支払い月で寄せる
            -- 減免額：支払い回数で割り、支払い月にセット。残りの月は0をセット
            -- 負担金：減免額と同様
            2.負担金に減免額は加えない（授業料と標準授業料の差分のみ）
            -- 減免額から負担金を除く
            3.支援金で特殊フラグを設定したとき、基準額・加算額のテキストボックスが使用不可になっていた

2019/08/13  1.負担金の修正漏れ
            2.負担金、減免額のPLAN作成を変更

2019/08/15  1.年組の初期値を空行に変更
            -- 年組が空行の時の組またがり表示をカット
            2.自治体補助金マスタに学校負担金ありの追加に伴い修正
            -- REDUCTION_MST.BURDEN_CHARGE_FLG1、REDUCTION_MST.BURDEN_CHARGE_FLG2
            3.入金済みのとき、更新しないように変更
            -- COLLECT_SLIP_PLAN_PAID_DAT.PLAN_PAID_MONEY_DATE IS NOT NULLの件数が1件以上

2019/08/16  1.補助金取得SQLの並び替えにランク、SEQ追加
            2.補助金のPLAN作成を変更

2019/08/26  1.ランクを取消したときの不具合修正

2019/08/27  1.テーブル追加に伴う修正
            -- REDUCTION_INCOME_DAT
            2.入金済みに関する文言追加

2019/08/28  1.所得割のNULL更新をカット
            -- REDUCTION_COUNTRY_DAT、REDUCTION_DAT

2019/09/03  1.PLAN作成の不具合修正
            -- 補助金、学校負担金
            2.確定後の減免の更新処理を変更

2019/09/11  1.補助金取得のときに参照する所得割を変更
            -- REDUCTION_PREF_GRADE_MSTの参照年度を参照

2019/09/30  1.再計算処理を変更
            -- 所得割があるとき、所得割からの算出が優先
            -- ただし特殊フラグがあり、前・後期の所得割が一つでもなかったら特殊フラグが優先

2019/10/21  1.補助金の金額区分が割合のときの計算方法変更

2019/11/01  1.減免の計算方法変更

2019/11/13  1.減免の授業料、授業料等を減免に統合
            2.減免が確定済のときも再計算チェックボックス使用不可に変更

2019/11/15  1.減免の算出を減免対象者のみに修正
            2.減免の算出を減免対象者＆減免対象項目ありに変更

2019/11/18  1.減免対象者の判定修正

2019/11/19  1.計算用のフィールドを追加。
            -- collect_slip_plan_limitdate_dat.sql(rev.70742)

2019/11/22  1.CSV出力ボタン追加
            2.計算方法修正

2019/11/25  1.REDUCTION_SCHOOL_DATのMONEY_1、MONEY_2には前期、後期の減免額をセット
            2.減免のPLAN作成を変更

2019/12/04  1.支援額合計や支援金のPLAN作成するとき、授業料を上限とする処理追加

2019/12/12  1.減免の参照テーブル変更に伴う修正
            -- reduction_school_target_mst.sql(rev.71166)
            2.後減免の場合、支援金・補助金などを引いた後の金額に対して行うよう変更

2020/01/27  1.支援金、補助金のランクに固定で「XX:なし」を追加
            2.減免がない（初めて開いた）場合、ランクに「なし」をセットし、後減免の値も加算して表示に変更

2020/06/19  1.特殊フラグカット
            2.減免欄を前期と後期に分ける
            3.入金済みの判定を前期と後期に分ける
            -- 確定チェックボックス欄に色表示追加
            -- 伝票番号欄は前期、後期ともに入金済みのとき背景色を変える
            4.再計算は前期、後期共に確定済み（入金済み）のとき使用不可
            5.PLANの各テーブルに前期・後期の決定額追加に伴い修正
            -- rep-reduction_burden_charge_plan_dat.sql(rev.74982)
            -- rep-reduction_country_plan_dat.sql(rev.74982)
            -- rep-reduction_plan_dat.sql(rev.74982)
            -- rep-reduction_school_plan_dat.sql(rev.74982)

2020/09/10  1.CSV DUMMYの名称をLASTCOLUMNに修正

2020/09/29  1.前回(2020/06/19)の修正漏れ
            -- 入金済みのとき、ランクの変更不可

2020/10/21  1.支援金のPLAN作成時の端数計算方法を変更

2020/12/04  1.リファクタリング
            2.CSVの最終列をDUMMYかLASTCOLUMNで扱うかを
              設定ファイル「prgInfo.properties」のプロパティー「csv_LastColumn」で
              切り替えるように変更

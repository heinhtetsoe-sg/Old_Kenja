# kanji=漢字
# $Id: 31211ada808a00a8e76e941e7f02c30a3f054caa $
/*** KNJX180 指導要録所見CSV取込(HTRAINREMARK_DAT) readme.txt***/

2006/11/07 m-yama   新規作成(処理：東京都KNJX160　レイアウト：東京都KNJX160参考)
2007/04/03 s-yama   データ取込の削除処理の条件に年度を追加しました。

2009/05/01  1.フィールド増加に伴う修正

2009/08/05  1.関数名の修正「mbstrpos」⇒「mb_strpos」

2009/09/16  1.ラジオボタン、チェックボックスにラベルを追加した。

2010/06/28  1.改行コードを「↓」に置き換える修正

2011/03/03  1.XLS出力処理追加
            -- プロパティー追加：useXLS(何かセットされていれば、XLS出力。基本'1'をセット。)

2011/03/18  1.テンプレートを1本に統一

2011/03/30  1.以下の修正をした
            -- 単独で呼び出された場合閉じる
            -- 親から呼ばれた場合は、親の権限を使用する

2011/04/01  1.テンプレートのパス修正

2011/04/07  1.タイトルの固定文字「(1.1)」を削除した。

2012/03/29  1.文字数チェックは、改行を除いたデータでチェックする。

2013/03/29  1.行数チェックを追加

2013/06/21  1.制限付きの教員も使用可能にした。

2013/07/29  1.KNJA120Dからコールされた場合の処理を追加

2013/08/27  1.総合所見及び指導上参考となる諸事項（TRAIN_REF1, 2, 3）をHTRAINREMARK_DETAIL_DATより表示、取込するよう修正

2013/09/04  1.年組指定時は、データのない人も出力する。

2013/11/11  1.不要な改行修正
            2.データ出力時のファイル名に年組を追加

2014/05/26  1.更新/削除等のログ取得機能を追加

2016/03/08  1.キャリアプラン欄追加

2016/03/15  1.DBエラー対応

2016/03/17  1.キャリアプラン欄追加の修正漏れ（HTRAINREMARK_DETAIL2_DATの削除機能）
            2.HTRAINREMARK_DETAIL_DAT、HTRAINREMARK_DETAIL2_DATの各対象項目がある場合のみ更新・削除を行う。

2016/04/04  1.KNJA121Kからの取り込みでwarningが表示されないように修正

2016/06/20  1.校種条件追加
            -- プロパティー「useSchool_KindField」とSCHOOLKINDを参照

2018/06/07  1.プロパティーseitoSidoYorokuHoushiNentaniが2の場合、奉仕の記録はHTRAINREMARK_HDAT.TOTALSTUDYACT2、TOTALSTUDYVAL2を使用する

2019/01/18  1.CSV出力の文字化け修正(Edge対応)

2019/03/19  1.名称マスタ「Z010」narakenの時、CSV項目「奈良Time」を追加

2020/09/09  1.CSV DUMMYの名称をLASTCOLUMNに修正

2020/10/07  1.KNJA120E(総合所見6分割)のCSV処理追加

2020/12/08  1.リファクタリング
            2.CSVの最終列をDUMMYかLASTCOLUMNで扱うかを
              設定ファイル「prgInfo.properties」のプロパティー「csv_LastColumn」で
              切り替えるように変更

2021/02/23  1.島根県の6分割のタイトル変更
            2.定義なし定数MSG202の文字列への置換(PHP7対応)

2021/03/10  1.CSVメッセージ統一(SG社)
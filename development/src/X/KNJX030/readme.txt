# kanji=漢字
# $Id$

2005/09/28 CSV書出にて、最終項目にダミー項目を追加・・・「１６行目以降のカンマが消える」の対応策として修正
2005/10/18 テーブル変更(緊急連絡先等)に伴う修正

2010/03/23  1.tokio:/usr/local/development/src/X/KNJX030からコピーした。
            2.年度＆学期コンボ、年組コンボを追加した。
            3.CSVの項目に学年、クラス、出席番号、氏名を追加した。
            4.ヘッダの見本を変更した。
            5.ラベル機能を追加した。
            6.リファクタリング

2010/08/04  1.TABをスペースに変換
            2.肩書き出力可フラグ追加
            -- rep-guardian_address_dat_rev1.4.sql
            -- rep-schreg_address_dat_rev1.8.sql
            3.エラーチェック追加

2011/02/21  1.XLS出力処理追加
            -- プロパティー追加：useXLS(何かセットされていれば、XLS出力。基本'1'をセット。)

2011/02/28  1.encoding指定

2011/03/18  1.テンプレートを1本に統一

2011/03/30  1.以下の修正をした
            -- 単独で呼び出された場合閉じる
            -- 親から呼ばれた場合は、親の権限を使用する

2011/04/01  1.テンプレートのパス修正

2011/04/07  1.タイトル文言をプロパティー「useXLS」で切り替えるよう修正した。

2012/04/19  1.CSV取込後のメッセージを変更
                - 処理済件数、エラー件数を表示
                
2012/04/23  1.AREACDにおいて、CSV取り込み時の処理修正
                - AREACDがnullの時、0をセット
                - AREACD=0または00の時、地区コードの名称マスタチェックを行わない

2012/04/24  1.AREACDがnullの時の仕様統一（KNJX030,KNJA040,KNJA110A）
                - AREACDがnullの時、'00'をセット

2014/06/20  1.ログ取得機能追加

2014/07/07  1.プロパティー「useAddrField2」の追加に伴う修正

2016/09/22  1.プロパティー「useSchool_KindField」とSCHOOLKINDを参照 

2016/12/29  1.電話番号２追加

2017/05/25  1.ADMIN_CONTROL_PRG_SCHOOLKIND_MSTを使って、校種を制御する。
            --プロパティー追加：use_prg_schoolkind

2018/05/14  1.データ出力で、※有効期間開始年月日が最大値のデータのみ出力するよう、変更

2019/01/18  1.CSV出力の文字化け修正(Edge対応)

2020/03/25  1.以下の修正をした。
            --メールアドレスを50桁まで取込可能に修正
            --住所を150桁まで取込可能に修正

2020/09/07  1.CSV DUMMYの名称をLASTCOLUMNに修正

2020/11/12  1.プロパティー「chkAddrInputHankaku」= 1の時、住所1/2に半角文字が混ざっていないか、チェックするよう、変更
              -- プロパティー「chkAddrInputHankaku」追加

2020/12/01  1.リファクタリング
            2.CSVの最終列をDUMMYかLASTCOLUMNで扱うかを
              設定ファイル「prgInfo.properties」のプロパティー「csv_LastColumn」で
              切り替えるように変更

2020/12/02  1.プロパティー「ADDR_INPUT_SIZE」に値が設定されている時、住所1/2の入力文字数がこのプロパティ値以下かチェックするよう、変更
              -- プロパティー「ADDR_INPUT_SIZE」追加

2021/03/12  1.CSVメッセージ統一(SG社)
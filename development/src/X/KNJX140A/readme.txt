# kanji=漢字
# $Id: readme.txt 76510 2020-09-07 08:31:42Z arakaki $

====================== ここから =====================================
基本時間割CSV処理 - KNJX140
----
以下は仕様
■主なテーブル
・sch_ptrn_hdat
・sch_ptrn_dat
・sch_ptrn_stf_dat

■各テーブルの関係図
(1) sch_ptrn_hdat
        |
        +--- (2) sch_ptrn_dat
                |
                +--- (3) sch_ptrn_stf_dat

■CSVデータ取込
・主なテーブルを全て取り込む
・更新：各テーブルに追加および更新する。
- 但し、sch_ptrn_stf_dat は職員コードが入力されている場合のみ、追加および更新する。(仲本)
- sch_ptrn_dat に入って、 sch_ptrn_stf_dat に入らない(高江洲)
・削除：各テーブルを講座単位で削除する。
つまり、(2),(3)を削除する。(1)は(2)がSEQ単位で、ゼロ件の場合のみ削除する。

■CSVデータ出力
・指定された年度・学期、タイトルの基本時間割をCSV出力する。

■ヘッダ出力
・テンプレートをCSV出力する。

■エラー出力
・エラーをCSV出力する。

■ヘッダ有り チェックボックス
・CSVデータ出力および取込を実行する際、ヘッダ有り無しを選択する。

■実行ボタン
・CSVデータ出力および取込を実行する。

■CSVデータ取込時のエラーチェック
・項目チェック（桁数・必須項目・数字・値）
・存在チェック（名称マスタ（校時コード）・講座データ・職員年度データ）
・ＳＥＱチェック１(一度に取込可能なＳＥＱは、１種類のみとする)
・ＳＥＱチェック２(パターン反映履歴データに存在するＳＥＱは、取込は許可しない)
----

====================== ここまで =====================================

2016/04/07  1.KNJX140(1.10)を元に新規作成。改訂版。
            -- ＣＳＶ項目に講座名称、職員氏名を追加

2019/06/07  1.データ出力のエラーチェック

2020/09/07  1.CSV DUMMYの名称をLASTCOLUMNに修正

2020/12/07  1.リファクタリング
            2.CSVの最終列をDUMMYかLASTCOLUMNで扱うかを
              設定ファイル「prgInfo.properties」のプロパティー「csv_LastColumn」で
              切り替えるように変更

2021/02/25  1.CSVメッセージ統一(SG社)

2021/03/10  1.京都PHPバージョンアップ対応

2021/04/07  1.CSVメッセージ統一(SG社)で行った、SCH_PTRN_HDATの重複チェックカット

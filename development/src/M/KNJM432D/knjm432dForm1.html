{rval start}
<table width="1000" border="0" cellspacing="10" cellpadding="0" align="center">
  <tr>
    <td>
      <table width="100%" border="0" cellspacing="0" cellpadding="1">
        <tr class="no_search_line">
          <th>
            <table width="100%" border="0" cellspacing="0" cellpadding="3">
              <tr class="no_search">
                <td width="300"><b>　　{rval TOP/YEAR}年度　　学期：{rval TOP/SEMESTER}</b></td>
                <td width="*"><b>{rval TOP/ORDER1}<LABEL for="ORDER1">学籍番号順</LABEL>　　科目：{rval TOP/SUBCLASSCD}<br>
                                                                      　　　　　　　　&nbsp;講座：{rval TOP/CHAIRCD}<br>
                                 {rval TOP/ORDER2}<LABEL for="ORDER2">クラス番号順</LABEL></b>
                </td>
              </tr>
            </table>
          </th>
        </tr>
      </table>
    </td>
  </tr>

  <tr>
    <td>
      <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <table width="100%" border="0" cellspacing="0" cellpadding="0">
              <tr class="no_search_line">
                <td>
                  <table width="100%" border="0" cellspacing="1" cellpadding="3">
                    <tr class="no_search" height="51px">
                      <th width="76"  align="center">学籍番号</th>
                      <th width="120" align="center">ハウス</th>
                      <th width="300" align="center">氏　　名</th>
                      <th width="75"  align="center">レポート</th>
                      <th width="90"  align="center">スクーリング</th>
                      <th width="75"  align="center">得点</th>
                      <th width="75"  align="center">評定</th>
                      <th width="*"   align="center">認定</th>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <td bgcolor="#ffffff">
            <div style="width: 100%; height: 500; overflow: auto">
            <table width="100%" border="0" cellspacing="0" cellpadding="0">
              <tr class="no_search_line">
                <td>
                  <table width="100%" border="0" cellspacing="1" cellpadding="3">
<!--{def data}-->
<!--{each data}-->
                    <tr style="height:30"; bgcolor="{rval data/COLOR}">
                      <td width="76"  align="center">{rval data/SCHREGNO}</td>
                      <td width="120" align="center">{rval data/HR_NAME}</td>
                      <td width="300" align="left">&nbsp;{rval data/NAME_SHOW}</td>
                      <td width="75"  align="center">{rval data/REPORT_CNT}</td>
                      <td width="90"  align="center">{rval data/SCHOOLING_CNT}</td>
                      <td width="75"  align="center">{rval data/SCORE}</td>
                      <td width="75"  align="center">{rval data/VALUE}</td>
                      <td width="*"   align="center" id="td-{rval data/SCHREGNO}" data-schNo="{rval data/SCHREGNO}" data-creditok="{rval data/m025cnt}" data-defColor="{rval data/COLOR}" class="changeColor">{rval data/GET_CREDIT}</td>
                    </tr>
<!--{/each}-->
<!--{/def}-->
                  </table>
                </td>
              </tr>
            </table>
            </div>
          </td>
        </tr>
      </table>
    </td>
  </tr>

  <tr>
    <td>
      <table width="100%" border="0" cellspacing="0" cellpadding="0" align="center">
        <tr class="no_search_line" >
          <td>
            <table width="100%" border="0" cellspacing="1" cellpadding="3">
              <tr class="no_search">
                <th>{rval button/btn_update}{rval button/btn_reset}{rval button/btn_end}</th>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
{rval finish}
<script language="JavaScript">
    document.addEventListener('click', function(e) {tdChangeColor(e)});
    document.addEventListener('mouseover', function(e) {tdChangeColor(e)});
    document.addEventListener('mouseout', function(e) {tdChangeColor(e)});

    function tdChangeColor(e) {
        var t = e.target;
        if (t.className == "changeColor") {
            var schNo      = e.target.getAttribute('data-schNo');
            var creditok   = e.target.getAttribute('data-creditok');
            var defColor   = e.target.getAttribute('data-defColor');
            targetCheckBox = document.getElementById("GET_CREDIT-" + schNo);

            switch (e.type) {
                case "mouseover":
                    t.style.backgroundColor = "pink";
                    break;
                case "mouseout":
                    t.style.backgroundColor = defColor;
                    break;
                case "click":
                    nullTextBox    = document.forms[0]["VALUE-" + schNo];
                    if (creditok == 1 || nullTextBox.value != "") {
                        targetCheckBox.checked = targetCheckBox.checked ? false: true;
                    }
                    break;
                default:
                    break;
            }
        }
    }
</script>

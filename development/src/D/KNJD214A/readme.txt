# kanji=漢字
# $Id: readme.txt 74321 2020-05-15 05:26:00Z arakaki $

学年評定へのコピー／クリア（KNJD214A）
--------------------
学校：新賢者（鳥取）
--------------------
主なテーブル
・RECORD_PROV_RATE_DAT
・TESTITEM_MST_COUNTFLG または TESTITEM_MST_COUNTFLG_NEW
prgInfo.properties の useTestCountflg を使用。
--------------------

2009/07/29  1.KNJD214を元に新規作成。

2009/07/30  1.実行時、9-99-00のレコードも一緒に処理する。
            -- コピー時のチェック処理（クリア処理が行われたか）は不要のため削除した。

2009/09/24  1.KNJD214を元に再作成。
            -- 仮評定（履歴）テーブルへのコピー処理を追加。

2010/02/08  1.ボタンの左側に文字追加「※ クリア／コピー処理後、序列確定の実行が必要です。」

2010/06/22  1.プロパティーファイルの参照方法を共通関数を使うよう修正

2010/11/05  1.７月評価がコピー元になる評価コンボに出てこない不具合を修正

2011/02/05  1.学年末評価（9-99-01）を学年末評定（9-99-00）にコピーする機能を追加。

2011/02/08  1.クリア処理の条件から「GRD_DATE、GRD_DIVがNULL」を削除した。

2011/07/13  1.「処理対象の生徒」について、以下の通り変更。
            -- 変更前：
            --   学籍基礎マスタ（SCHREG_BASE_MST）の「卒業区分（GRD_DIV）」「卒業日付（GRD_DATE）」の
            --   どちらかに値が登録されている生徒は処理対象から除外する。
            -- 変更後：
            --   学籍基礎マスタ（SCHREG_BASE_MST）の「卒業区分（GRD_DIV）」「卒業日付（GRD_DATE）」の
            --   両方に値が登録されている生徒は処理対象から除外する。
            --   但し、「卒業区分（GRD_DIV）」に「4:卒業見込」の値が登録されている生徒は処理対象とする。

2012/02/17  1.クリアの横に「総学等も含む」チェックボックスを追加
            -- デフォルトはチェックなし
            -- チェックありの場合、総学等もクリアする
            2.コピーは「総学等は処理対象外」とするよう変更

2012/07/05  1.教育課程の追加、追加に伴う修正
            -- Properties["useCurriculumcd"]=1のときのみ、教育課程処理に対応

2013/07/05  1.名称マスタのマスタ化に伴う修正

2014/01/31  1.指定された成績をそのまま学年成績にセットする。
            -- 熊本県仕様

2014/06/25  1.実行履歴の処理を追加
            -- ・KNJD214Vと同様に、実行履歴を登録する。
            -- ・実行履歴の一覧に、削除欄追加、【実行履歴データ削除】ボタン追加
            -- ・実行履歴（RECORD_COPY_EXEC_DAT）データ削除とのことですけど、レコード削除は、心配なので、
            -- 　無効フラグを追加して、チェックボックスonの時は、無効フラグ’1’をセツトする。
            -- ・無効フラグ’1’は、一覧に表示しない。
            --     record_copy_exec_dat.sql(1.2)
            -- rep-record_copy_exec_dat.sql(1.1)

2014/08/06  1.下記の学校の時は、コピー元になる評価で「学年成績（9-9900のSCORE）」を選択できるように修正
            -- 中京（修正要望）・智辯・鳥取・熊本

2015/07/21  1.プロパティーuseAssessSubclassMst=1の場合、評定コピーの換算でASSESS_SUBCLASS_MSTも使用する

2016/03/15  1.プロパティーuseAssessCourseMst=1の場合、評定コピーの換算でASSESS_COURSE_MSTも使用する

2016/03/22  1.プロパティーuseProvFlg=1の場合、評定フラグのラジオボタンを表示する。
            -- ○本評定　◎仮評定
            2.コピーで仮評定を生成した際、RECORD_PROV_FLG_DATに「コピー元になる評価」をセット
            --     record_prov_flg_dat.sql(1.3)
            -- rep-record_prov_flg_dat.sql(1.2)
            3.実行ボタンを押した際、確認メッセージを表示する。
            -- 例）
            -- 成績データ（コピー先）は、
            -- 【本評定】です。
            -- このまま処理を実行しますか？
            4.プロパティーuseProvFlg=1の場合、コピー処理は、
            -- コピー前チェック（クリアしたか）をしない。
            -- つまり、クリアしてコピーする。

2016/03/23  1.プロパティーuseProvFlg=1以外の場合、2016/03/22修正前の状態とする。

2016/03/29  1.学年コンボの参照先をSCHREG_REGD_GDATに変更
            2.ラジオボタン、チェックボックスにラベル機能追加
            3.実行履歴を修正
            -- 行選択でチェックをon/offするように変更
            -- チェックがonのとき、背景色を付ける

2020/05/15  1.名称マスタ「"D" + "校種" + "08"」が1件でもあれば「"D" + "校種" + "08"」を参照する
             -- 上記以外は「D008」を使用

2021/03/05  1.コード自動整形
            2.熊本の時、コピー元になる評価に「１・２学期の平均(19900,29900の平均)」を追加

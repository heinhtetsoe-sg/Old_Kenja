# kanji=漢字
# $Id: readme.txt 75830 2020-08-04 09:15:05Z ishii $

仮評定・学年評定へのコピー／クリア
--------------------
学校：宮城県（パーツタイプ）
--------------------
主なテーブル
・RECORD_PROV_RATE_DAT
・TESTITEM_MST_COUNTFLG または TESTITEM_MST_COUNTFLG_NEW
prgInfo.properties の useTestCountflg を使用。
--------------------

2013/07/30  1.KNJD214A(1.14)を元に新規作成。
            -- パーツタイプ仕様を追加「コピー先選択(仮評定)」

2013/08/01  1.評定フラグのテーブル追加に伴う修正
            -- 評定フラグが仮評定の場合、レコードを追加(1をセット)
            -- 評定フラグが本評定の場合、レコードを削除

2013/08/02  1.処理対象科目チェックボックス追加

2014/01/22  1.コンボのラベル表示を修正
            -- 学期名＋ハイフン＋考査種別名
            -- ・保存先になる仮評定コンボ
            -- ・コピー元になる評価コンボ

2014/02/26  1.「追指導は参照する」チェックボックスを追加
            -- 評定１または欠席の場合のみ処理
            -- 追指導（記号）が全て○の場合、評定２をセット
            -- 追指導（点数）が評定２の下限値以上の場合、評定２をセット
            2.「欠課時数オーバーは未履修にする」チェックボックスを追加
            -- 本評定かつ評定１以上の場合のみ処理
            -- 欠課数が上限値をオーバーした場合、履修・修得単位に０をセット

2014/02/28  1.欠課数が上限値をオーバーした場合、
            -- 修正前：履修・修得単位に０をセット
            -- 修正後：学年評定、履修・修得単位に０をセット

2014/05/22  1.コピー元になる評価コンボに仮評定も表示するように修正
            -- 保存先になる仮評定と同じ場合はエラーとする

2014/05/27  1.実行履歴の表示を追加
            -- record_copy_exec_dat.sql(1.1)

2014/05/28  1.相対評定マスタの設定がある場合、相対評定マスタを参照。設定がない場合、評定マスタを参照。

2014/05/30  1.更新/削除等のログ取得機能を追加

2014/06/25  1.実行履歴の削除処理を追加
            -- ・実行履歴の一覧に、削除欄追加、【実行履歴データ削除】ボタン追加
            -- ・実行履歴（RECORD_COPY_EXEC_DAT）データ削除とのことですけど、レコード削除は、心配なので、
            -- 　無効フラグを追加して、チェックボックスonの時は、無効フラグ’1’をセツトする。
            -- ・無効フラグ’1’は、一覧に表示しない。
            --     record_copy_exec_dat.sql(1.2)
            -- rep-record_copy_exec_dat.sql(1.1)

2014/06/30  1.DBエラーの不具合を修正

2014/09/26  1.欠課数が上限値をオーバーした場合、
            -- 修正前：学年評定、履修・修得単位に０をセット
            -- 修正後：学年評定にnullをセット、履修・修得単位に０をセット

2016/04/15  1.追指導入力設定が１つでもある場合、追指導チェックボックスを表示する。
            -- TESTITEM_MST_COUNTFLG_NEW_SDIV.SIDOU_INPUT = '1'

2016/09/19  1.学年コンボ修正
            -- プロパティー「useSchool_KindField」とSCHOOLKINDを参照
            -- 表示を SCHREG_REGD_GDAT の GRADE_NAME1 に変更

2017/03/28  1.欠課時数オーバーは合併元科目の欠課数も加算してチェックする

2017/09/08  1.ADMIN_CONTROL_PRG_SCHOOLKIND_MSTを使って、校種を制御する。
            --プロパティー追加：use_prg_schoolkind

2017/12/01  1.ASSESS_COURSE_MSTを使用するパターンを追加

2018/02/09  1.ASSESS_SUBCLASS_MSTを使用するパターンを追加

2018/06/25  1.プロパティーknjd214vCopyClassCd90が1の場合、評定コピーの対象に総学等を含める
            --常盤木は各考査で総学に得点を入力し評定コピーする

2018/07/17  1.D065にある科目は評定換算しない
            --文字評定対応（埼玉栄要望）

2018/10/29  1.評定クリアの際、D008の科目は「総学等も含む」にチェックしない場合、クリアしない
              評定コピーの際、前処理のクリア済チェックの対象科目にD008の科目を含めない

2019/02/26  1.追指導入力の参照で記号の場合、コピー元テスト種別のみで判定する。

2019/03/04  1.プロパティーuseAssessTestcountMstが1の場合、評定換算はASSESS_TESTCOUNT_MSTを使用する。

2020/05/14  1.名称マスタ「"D" + "校種" + "08"」が1件でもあれば「"D" + "校種" + "08"」を参照する
             -- 上記以外は「D008」を使用

2020/06/08  1.プロパティーuseAssessAvgMstが1の場合、評定換算はASSESS_AVG_MST、ASSESS_AVG_CALC_MSTを使用する
            -- assess_avg_mst.sql (rev.74392)
            -- assess_avg_calc_mst.sql (rev.74573)
            ※ 花園から要望

2020/08/04  1.「コピー元になる評価コンボ」に出すテスト種別を以下のように修正
            --既存(SCORE_DIV=08,09) + 名称マスタD111に登録したテスト種別(形式:SEMESTER-TESTKINDCD-TESTITEMCD-SCORE_DIV)
            ※ 山村学園から要望

2021/04/05  1.コード自動整形
            2.名称マスタ「D116」に登録した科目は合併元で成績入力無しでも単位加算の対象とする
            3.学校マスタに校種指定追加

2021/04/09  1.名称マスタ「D116」に登録した合併元科目はRECORD_SCORE_DATがなくても講座名簿があれば単位加算の対象とする

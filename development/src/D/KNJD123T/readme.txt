// kanji=漢字
// $Id: readme.txt 56586 2017-10-22 12:52:35Z maeshiro $

/*** KNJD120T成績入力処理(前後期制) readme.txt***/

2005/01/28 新規作成
2005/04/13 ALP修正(帳票用パラメータ追加)
2005/05/23 管理でログインしても、管理者コントロールはみてもらいたい

/*** KNJD123T成績入力処理(前後期制) readme.txt***/

2005/05/24 １．ALP修正(KNJD120Tを元にKNJD123Tとして新規作成)
           ２．公欠(KK)、欠席(KS)の入力を行わない
           ３．出欠コードの内容でバックカラーの色(青、緑、赤)を変えて表示する
           ３．１ SCH_CHR_TEST,ATTEND_DATを参照して色表示する
           ３．２ 出欠コードが複数存在する場合、小さい方の出欠コードを優先表示する
           ４．在籍情報の黄色表示は、今学期までとする

2005/05/27 同一科目、別講座、同一生徒の成績を別講座それぞれで入力可能へ修正
2005/06/08 ALP修正(中間・期末・学期評価に欠課時数情報「'-','='」を入力可能へ修正)

2005/06/20 ALP修正
　1131911の講座と1131913の講座に属していて、成績入力画面で両方の講座に生徒が表示される不具合がありました。
　時間割生徒データから生徒を抽出する方法
　　＜仕様追加＞
　　　①学籍処理日（今日の日付）を基準にして生徒抽出してください。（初期値）
　　　②管理者コントロール（admin_control_dat）に登録されている試験で、時間割講座テスト（sch_chr_test）の
　　　　試験日に属している生徒を表示してください。
　　　　　　・中間素点と中間評価は中間テスト日、
　　　　　　・期末素点と期末評価と学期評価は期末テスト日、
　　　　　　・学年評価は最終学期の期末テスト日
　　　③管理者コントロールで複数ＯＮになっている時は、最終のテストに登録されているテスト日で生徒抽出する。
　　　④同一講座で、テスト日が複数あれば、ＭＡＸ日で生徒抽出する。

2005/08/16 ALP修正(帳票用パラメータ「試験日」追加)
2005/09/13 ALP修正(「科目」と「講座」未選択の場合、印刷ボタン押し下げ時にエラーメッセージ表示)
2005/09/28 ALP修正
           １．「平均」を小数点第２位で四捨五入して、小数点第１位まで表示
           ２．欠時数、欠課数に「sick」も加算する修正を追加
           ３．CSV書出にて、最終項目にダミー項目を追加・・・「１６行目以降のカンマが消える」の対応策として修正
2005/10/06 ALP修正(定期考査の出欠の表２のSQL不具合修正)


2005/10/28 ALP修正(累積情報を帳票で出力する為、パラメータを追加)
2005/11/11 修正NO001 alp nakamoto 修正依頼20051031メールでの修正
2005/12/14 修正NO002 alp nakamoto 学年評定に記号「'-','='」を入力可能へ修正
2005/12/21 修正NO003 alp nakamoto 更新時、表示のみの記号「'-','='」が消える不具合を修正

2006/03/09 修正NO004 alp nakamoto 半期認定に対応。学年評定と欠課数を参照し、「履修・修得単位」をセットするよう修正。
2006/03/10 修正NO005 alp nakamoto 科目コードの頭２桁'90'を表示するように修正。関連箇所もあわせて修正。
2006/03/17 修正NO006 alp nakamoto 学年評定が入力されていない場合、「履修単位(COMP_CREDIT)／修得単位(GET_CREDIT)／履修学期区分(COMP_TAKESEMES)」に'NULL'をセットするよう修正。
2006/03/17 修正NO007 alp nakamoto 通常科目で学年評定が２以上ある場合、欠課数が上限値をオーバーしても「履修単位(COMP_CREDIT)／修得単位(GET_CREDIT)」に単位数をセットするよう修正。
2006/05/18 修正NO008 alp nakamoto 修正依頼20060518メールでの修正

2006/06/08 alp o-naka NO009 record_dat変更による修正 --- 各素点の講座コードについて
                      NO010 上記2005/06/20修正内容について、一部変更。「学年評価は最終学期の期末テスト日」<=== カット。
                      NO011 TAKESEMESに'0'を固定でinsert。(function insertEx_Std_RecQuery)

2006/09/20 alp o-naka 上記2005/06/20の②の仕様について、下記の通りに変更した。
・中間素点は中間テスト日、
・期末素点は期末テスト日、
・中間・期末素点以外は学籍処理日

2006/10/20 alp o-naka 「成績入力完了チェックの入れ忘れ防止対策」
更新時、下記の場合、メッセージを表示するように修正した。
・「成績が全て未入力」で「成績入力完了チェックあり」の場合、警告メッセージを表示する。（更新できない）
・「成績が全て入力済」で「成績入力完了チェックなし」の場合、確認メッセージを表示する。（更新するかしないかを選択する）

2006/11/22 alp o-naka 履修単位・修得単位の入力欄を追加した。
・管理者コントロールコード「0884：履修単位」「0885：修得単位」を参照。
・テキスト入力可の場合は、自動計算しない。
・MAX２桁まで入力可。

2006/12/27 alp o-naka 単位入力欄の入力可／不可の区別を変更した。
・学年評定欄の管理者コントロールの指定に依存する。
・よって、管理者コントロールのコード「0884：履修単位」「0885：修得単位」は廃止。
・成績処理改訂版。

2007/01/11 alp o-naka 単位の自動計算する処理を変更した。（成績処理改訂版）
・基本前提
  単位入力欄が入力可で、学年評定が入力されていて、履修単位／修得単位が null の時、自動計算する。
  それ以外は、自動計算しない。（値そのまま）
・合併先科目の場合、
  科目合併設定データの単位固定／加算フラグを参照し、
  「1:単位固定」なら、単位マスタから合併先科目の単位数を取得して登録する。
  「2:単位加算」なら、生徒が選択した合併元科目の単位数を加算した値を登録する。
・教科コード'90'以上の場合、
  学年評定１以上なら履修単位／修得単位に登録する。欠課時数はチェックしない。
・教科コード'90'未満の場合、
  現在の自動計算と同じ処理をして登録する。（評定・欠課時数を元に単位を取得して登録）

2007/01/19 alp o-naka 単位の自動計算する処理を修正した。（成績処理改訂版）
・合併先科目の場合、
  学年評定１なら修得単位にゼロを登録する。

2007/03/07 単位の自動計算する処理を修正した。（成績処理改訂版）
-- ”教科コード'90'以上”の処理を削除した。
-- ”教科コード'90'未満”の条件を”合併先科目でない”に変更した。
-- よって、単位の自動計算する処理の場合分けは、
-- ”合併先科目でない”と”合併先科目である”の２つである。

2008/06/04  1.機能追加。Enterキーでのカーソル移動。

2008/10/10  1.出欠累計の欠時数に保健室欠課(nouseoff)を加算追加。
            2.出欠累計にNULLデータが存在する場合でも累計できるようにした。

2008/10/14  1.生徒を抽出する条件の日付。学籍処理日が学期範囲外の場合、学期終了日を使用する。

2009/02/04  1.名称マスタの値によって、合併元科目の「評定＝１（履修のみ）」の扱いを変えるよう修正。
            2.名称マスタは「V_NAME_MST」を参照するようにした。
            3.在籍データに存在しない学籍番号が最終行に表示される不具合を修正。

2009/02/12  1.固定文字の表示を以下の通り修正。
            ・学期マスタの学期名を表示。
            ・テスト項目マスタのテスト項目名の頭３文字を表示。
            ※「prgInfo.properties」の「useTestCountflg」を参照。

2009/03/11  1.帳票へ渡すパラメータを修正。累積現在日の「年度」を「年（西暦）」に変更。

2009/04/09  1.学校マスタのフラグ（LESSON_OFFDAYS）を参照し「休学時の欠課をカウントする」処理を追加。

2009/05/19  1.学校マスタのテーブル変更に伴う修正。「休学・公欠・出廷・忌引・出廷（伝染病）」を欠課に含める処理。

2009/05/20  1.エクセルからの貼付け機能を追加
            2.貼付け機能を追加で空白を無視してしまうのを修正

2009/05/22  1.アラートの「クリップボード」という文字のカット

2009/05/27  1.貼付け処理を共通関数を使うよう修正
            2.クリップボードのチェック処理の修正、足りないフィールドの追加

2009/06/02  1.一覧表の行を交互に色をつける修正

2009/06/03  1.考査満点マスタを参照するよう修正

2009/06/23  1.以下の修正をした。
            -- 一覧の表示は5行ごとに色を変えるよう修正
            -- 評定・評価の「成績入力完了チェックボックス」追加(RECORD_CHKFIN_DATを更新)
            2.RECORD_CHKFIN_DAT更新時に使う配列の値の修正

2009/07/09  1.以下の修正をした。
            -- 「総合的な学習の時間」等の「評定を設定しない科目」に対して
            -- 科目合併が設定された場合の扱い。

2009/07/10  1.以下の状態を修正。レイアウト調整。
            -- ・画面下のボタン類が、スクロールしないと見えない状態。
            -- ・画面下のボタン類が、少しだけ見えない状態。
            -- ※動作環境・・・OS：XP／IE7

2009/07/13  1.成績入力完了にチェックが入っていて入力欄にnullがあれば確認を求めるよう修正
            2.変数名修正

2009/07/14  1.共通関数の修正に伴う修正

2009/08/03  1.以下の通り修正。
            -- 欠課数上限値が「NULL」の場合は「９９」に読み替えて処理する。

2009/08/05  1.実・法定欠課時数上限の修正。

2009/08/06  1.実・法定欠課時数上限の修正。

2009/09/07  1.メンバ変数の初期化を init() で処理するように変更。

2010/02/15  1.学期の条件を削除した。
            -- 欠時数が画面と点票で違う不具合の修正。

2010/06/21  1.プロパティーファイルの参照方法を共通関数を使うよう修正
            2.プロパティーの初期設定の修正

2011/04/12  1.CSV入出力の機能をカット。

2011/10/27  1.「参照可能」「参照可能・制限付」の時、更新ボタンを押したら、メッセージを表示する。
            -- 例：この処理は許可されていません。(MSG300)

2012/01/30  1.読み込み中は、更新ボタンをグレー（押せないよう）にする。

2012/02/14  1.スペースチェックを追加
            -- スペース文字があればエラーメッセージを表示する。
            -- 例：入力された値は不正です。「スペース」が混ざっています。

2012/03/13  1.スペースチェックをカット。
            -- スペース文字があればスペース文字を削除する。

2012/05/11  1.素点の成績入力完了チェックについて修正
            -- プロパティー「useRecordChkfinDat = 1」追加に伴い修正
            -- 成績完了チェックフラグ更新処理
            -- 1の場合：RECORD_CHKFIN_DATのRECORD_DIV='1'と'2'を更新
            -- 1以外　：RECORD_CHKFIN_DATのRECORD_DIV='2'と、SCH_CHR_TESTを更新

2012/05/28  1.教育課程の追加、追加に伴う修正
                - Properties["useCurriculumcd"]=1のときのみ、教育課程処理に対応

2013/07/03  1.名称マスタのマスタ化に伴う修正

2013/08/19  1.DI_CD'19','20'ウイルス/DI_CD'25','26'交止追加に伴う修正
            -- rep-attend_semes_dat.sql(rev1.9)
            -- rep-attend_subclass_dat.sql(rev1.11)
            -- v_attend_semes_dat.sql(rev1.7)
            -- v_attend_subclass_dat.sql(rev1.4)
            -- v_school_mst.sql(rev1.20)
            2.プロパティーuseVirus、useKekkaJisu、useKekka、useLatedetail、useKoudome追加

2013/12/18  1.Enterキーによるカーソル移動機能を追加
            2.仮評定の項目追加

2013/12/26  1.仮評定の追加対応するプロパティ追加
              - useProvFlg = '1'の時のみ対応する

2014/02/26  1.更新時、サブミットする項目使用不可

2014/02/28  1.更新時、サブミットする項目使用不可。ソース整理

2014/03/04  1.更新時のロック機能(レイヤ)を追加

2014/04/01  1.成績入力完了チェックの修正
            -- 教科９０の場合、学年評定欄がＮＵＬＬだとチェックが入らない。
            -- この場合、履修・修得単位が入力されていれば、入るように変更。

2014/04/22  1.更新時のロック機能(レイヤ)はプロパティ「useFrameLock」= '1'の時、有効
            2.貼り付け機能の修正
                - 関数名を修正 show ⇒ showPaste
            3.Enterキーによるカーソル移動機能修正

2015/07/21  1.出欠データの参照条件を変更
            -- 指定の講座コード
            -- 指定科目の講座データの講座コード

2016/04/01  1.成績が別講座の生徒に上書される不具合修正
            -- 生徒を表示する時に、学籍番号を保持しておくのではなく、
            -- 更新時に、学籍番号を取得し更新するように修正。
            -- ※その他も同様
            -- ・単位情報：単位自動計算で使用
            -- ・表示のみ成績：入力窓がない欄

2017/03/07  1.ADMIN_CONTROL_DATキー追加
            -- rep-admin_control_dat.sql(rev1.1)

2017/07/03  1.ADMIN_CONTROL_PRG_SCHOOLKIND_MSTを使って、校種を制御する。
            --プロパティー追加：use_prg_schoolkind

2017/09/20  1.DI_CD(29-32)追加

2017/10/02  1.ATTEND_DI_CD_DAT移行
            -- attend_di_cd_dat.sql(1.2)

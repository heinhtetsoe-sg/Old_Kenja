/*** KNJA120 生徒指導要録（所見入力）賢者版 ***/
$Id: readme.txt 76795 2020-09-11 06:12:34Z ishii $

2006/04/28 o-naka NO001 <textarea>タグのwrap属性を"hard"から"soft"に変更
           o-naka NO002 警告メッセージを表示する場合、入力した内容の表示が消える不具合を修正(活動内容/評価)
2006/07/05 o-naka 通知票所見参照にて、年度コンボを追加
                  通知票所見参照での表示について、全ての学期を表示するように修正した。
                  近大の場合、通知票所見参照ボタンを非表示とするようにした。

2006/11/10 m-yama 指導要録所見データとヘッダデータのCSV処理呼び出しのボタンを追加した。

2006/11/30 m-yama 指導要録所見データへのパラメータ(フィールドサイズ)を変更した。

2007/01/15 o-naka CSVボタンの位置を逆にした。
                  CSVボタンの文言を変更した。

2007/01/19 o-naka 左画面の年度・学期表示を年度コンボに変更し、右画面では、その選択した年度・学期を参照するように変更した。

2007/02/22 s-yama 「※1 データCSV」を削除しました。
                  CSVボタンの文言を変更しました。

2007/02/23 s-yama "TOTALSTUDYACT"と"TOTALSTUDYVAL"をHTRAINREMARK_DATから出力するように変更しました。
                  "TOTALSTUDYACT"と"TOTALSTUDYVAL"の文字数を変更しました。

2007/02/27 s-yama 「※1」「※2」を削除しました。

2007/06/08 s-yama 部活動参照ボタン、委員会参照ボタンを追加した。

2007/06/19 s-yama 通知票所見参照の年度コンボのデフォルトを左画面の年度コンボと同様にするよう変更した。
　　　　　　　　　通知票所見参照に奉仕を追加した。
                　委員会参照の年度条件を左画面で選択した年度にし、年度・学期を表示するように変更した。

2007/06/19 s-yama 通知票所見参照の年度コンボに左画面の年度がない場合の修正をしました。

2008/03/17  1.リネームKNJA120 → KNJA120A

2009/04/17  1.「出欠備考参照」「調査書(進学用)の出欠の記録参照」ボタン追加

2009/10/23  1.ログイン年度ではなく、左フレームからの年度を使うよう修正

2009/10/28  1.「活動内容」「評価」の入力可能なサイズを「prgInfo.properties」のフラグで変えるよう修正
            2.SCV取込みのプログラムに送るフィールドサイズを修正

2009/11/02  1.「prgInfo.properties」の「seitoSidoYorokuFieldSize」が'1'の時、下記のようになるよう修正
            「特別活動所見」   (全角11文字X6行まで) ⇒ (全角22文字X10行まで)
            「総合所見」       (全角44文字X6行まで) ⇒ (全角66文字X6行まで)
            「出欠の記録備考」 (全角20文字X2行まで) ⇒ (全角40文字X2行まで)

2009/11/06  1.prgInfo.properties の seitoSidoYorokuSougouFieldSize = 1の時も、総合所見(66文字×6行)に修正

2009/11/10  1.「成績参照」「資格参照」ボタン追加

2009/11/30  1.prgInfo.properties の seitoSidoYorokuSougouFieldSize = 1の時は、総合所見(66文字×7行)に修正

2009/12/10  1.prgInfo.properties の useQualifiedMstで資格参照の表示を切り替える処理追加
            2.条件分子の修正

2010/01/29  1.prgInfo.properties の seitoSidoYorokuSougouFieldSize = 1の時は、総合所見(66文字×8行)に修正

2010/02/02  1.特別活動所見のフラグを「seitoSidoYorokuSpecialactremarkFieldSize」に修正
            2.文字数チェックを行数チェックに変更

2010/03/17  1.「出欠備考参照」ボタンのパラメーターにSDATEとEDATEを追加

2010/03/18  1.ModelのgetPropertiesAll()を使うよう修正
            2.「通知表所見参照」の表示をプロパティーファイルで制御できるよう修正
            --テーブル追加(RECORD_TOTALSTUDYTIME_DAT)に伴う修正

2010/03/19  1.「HREPORTREMARK_DAT」と「RECORD_TOTALSTUDYTIME_DAT」の参照フィールドの修正
            --「通知表所見参照」で「TOTALSTUDYACT」をカット

2010/04/05  1.「部活動参照」、「資格参照」を取得年度のみ表示するよう修正した。

2010/04/22  1.「availheight」を「availHeight」に修正

2010/05/06  1.「通知書所見参照」のポップアップから年度コンボをカット

2010/09/06  1.成績参照画面に中高一貫校の条件を追加した。

2010/10/14  1.テキストエリアの行の桁数を「文字数*2+1」にした。

2011/03/04  1.委員会参照画面に学期を追加した。

2011/03/15  1.prgInfo.properties の 追加
            -- seitoSidoYoroku_dat_TotalstudyactSize = ○ * △ 活動内容(○文字×△行)に修正
            -- seitoSidoYoroku_dat_TotalstudyvalSize = ○ * △ 評価(○文字×△行)に修正

2011/04/05  1.文字数チェックをバイトチェックに変更した。

2011/10/05  1.CSV処理に渡すフィールドサイズの不具合を修正した。

2012/06/01  1.プロパティー「useCurriculumcd」を追加した。
            -- '1'がセットされている場合は教育課程コード等を使うようにした。

2012/10/01  1.明治の場合の総合的な学習の時間の記録欄を修正した。
            -- 活動内容をカットした。
            -- 評価の項目名を「Catholic Spirit」に変更した。
            2.以下の修正をした。
            -- 権限渡し
            -- エクセル出力ボタン表示有無

2013/01/09  1.CLASS_MSTテーブルのCURRICULUM_CDをカット

2013/03/29  1.行数のパラメータ追加

2013/06/20  1.出欠備考参照ボタンの参照先を切替処理追加
                - Properties["useAttendSemesRemarkDat"]の値により切替を行う
                
2013/06/25  1.出欠備考参照ボタンの表示名を修正
                - Properties["useAttendSemesRemarkDat"] = 1の時、まとめ出欠備考参照
                - それ以外、日々出欠備考参照
                - 生徒を選択していない場合は、エラーメッセージを出力

2013/07/04  1.部活動参照ボタンの位置を変更した。

2013/07/08  1.useTuutisyoSyokenNendo = 1の時、通知表所見の年度コンボを表示する。

2013/07/29  1.prgInfo.properties の 追加
            -- seitoSidoYoroku_dat_TotalremarkSize = ○ * △ 総合所見(○文字×△行)に修正
            -- seitoSidoYoroku_dat_SpecialactremarkSize = ○ * △ 特別活動所見(○文字×△行)に修正
            -- seitoSidoYoroku_dat_Attendrec_RemarkSize = ○ * △ 出欠の記録備考(○文字×△行)に修正
            2.チェック処理修正

2013/08/28  1.部活動の参照内容を修正
                - 入部日、退部日が年度開始日、終了日の場合も条件に含まれるよう修正
                
2013/08/29  1.部活動および委員会取込ボタンを追加
              - 部活動は、在籍している部活のみ対象
              - 部活動の退部日付がnullの時は、ログイン年度が対象
              - 委員会は、指定年度が対象
            2.取込ボタンの色を変更
            3.取込ボタンでコピーする際、フォーカスの位置からコピーする。

2013/08/30  1.取込ボタンの色を再変更

2013/09/04  1.総合所見参照ボタン追加

2013/09/04  1.ボタン名称変更 総合所見参照 → 全年度参照

2013/09/10  1.ボタン名称変更 全年度参照 → 過年度参照
            2.プロパティuseTorikomiAttendSemesRemarkDat = 1の時（#useAttendSemesRemarkDat = 1の時のみ設定有効）
              - まとめ出欠備考参照 ⇒ まとめ出欠備考取込に変更
              
2013/09/11  1.プロパティuseTorikomiAttendSemesRemarkDat = 1の時のまとめ出欠備考取込の仕様を修正
                - 取込データがない場合は、空白とする

2013/10/29  1.調査書より読込ボタンを追加
              - 3年生のみボタンを表示
              
2014/01/16  1.通知票より読込ボタンを追加 (KNJA120と同じ仕様)
              - 近大の場合は総合的な学習の時間より読込とボタン名を変更
              - コンボの年度（セットされていない時はログイン年度）を指定して読み込む
              
2014/02/13  1.通知票より読込ボタン（近大の場合は総合的な学習の時間より読込）の位置を変更

2014/04/15  1.（高セキュリティー）子画面の戻るボタンが機能しない不具合を修正

2014/05/23  1.tyousasyoShokenPreviewが'1'の場合、調査書所見プレビューボタンを表示

2014/05/26  1.更新/削除等のログ取得機能を追加

2015/03/02  1.総合的な学習の時間の記録にSCHREG_REGD_GDATのGRADE_CDにより判断し、下記のボタンを追加および修正
              - 1,2年次は通知票取込ボタン(プロパティ「tutihyoYoriYomikomiHyoujiFlg」= '1'で表示)に修正
              - 3年次は調査書取込ボタンを追加

2015/03/24  1.名称マスタ(NAMECD1:Z010 / NAMECD2:00 / NAME1:sapporo)のとき、下記を修正
            -- 通知表所見参照ボタンを非表示
            -- HTRAINREMARK_DATのデータがないとき、特別活動所見に初期値として固定文言を表示

2015/03/25  1.特別活動の所見にCSVパラメータにプロパティ「seitoSidoYoroku_dat_SpecialactremarkSize]」設定時の値を追加
            2.総合所見にCSVパラメータにプロパティ「seitoSidoYoroku_dat_TotalremarkSize]」設定時の値を追加
            3.出欠の記録備考にCSVパラメータにプロパティ「seitoSidoYoroku_dat_Attendrec_RemarkSize]」設定時の値を追加
            
2015/03/26  1.特別活動の所見のパラメータの設定値を修正

2015/05/15  1.添付書類PDF取込機能を追加
              - プロパティ（useUpdownPDF = 1）の場合、使用する。

2015/07/24  1.部活動取込ボタン押下時、最初に対応レコードのみを取得し、その後で項番を付けて表示するよう修正

2015/08/10  1.京都西山は通知表所見参照ボタンは非表示とする

2015/11/13  1.データ変更後更新せずに、生徒を選択しようとしたらエラーメッセージ表示する。

2016/02/10  1.資格取得では、取得日の年度にかかわらず全て表示するよう修正

2016/03/08  1.キャリアプラン欄追加
            -- プロパティ「seitoSidoYoroku_Totalstudyact2_val2_UseTextFlg」が"1"のとき、表示する。

2016/03/17  1.記録備考参照ボタン追加
            -- プロパティ「club_kirokubikou」が"1"のとき、表示する。

2016/06/24  1.ボタンの文言を「記録備考参照」→「大会記録備考参照」に変更

2016/08/08  1.ver. 5.6で発生するエラー修正
            2.通知票取込ボタン追加
            -- 三重県のとき、出欠備考参照ボタンを通知票取込ボタンに切り替える

2016/08/09  1.部活参照画面に備考表示追加
            2.資格参照画面でプロパティー「useQualifiedMst」が'1'のときに略称表示追加

2016/09/26  1.委員会参照、部活動参照、大会記録備考参照、委員会取込、部活動取込修正
            -- プロパティー「useSchool_KindField」とSCHOOLKINDを参照

2016/10/21  1.委員会取込、部活動取込ボタンのIE11からの仕様(document.selectionが廃止)に対応

2017/01/11  1.委員会取込内容を変更。（役職名を追加。「／」より後がブランクの場合表示しない。）

2017/01/16  1.部活動取込内容を変更。（役職名を追加。「／」より後がブランクの場合表示しない。）

2017/05/19  1.部活動取込、委員会取込処理を変更

2017/06/14  1.前回の修正もれ
            -- IE11未満の対応

2017/07/24  1.「資格参照」に、"主催"を追加

2017/08/01  1.各参照ボタンで、日付の和暦表示切替処理追加
            --プロパティ useWarekiHyoji = 1 の時、和暦で表示する

2017/08/30  1.出欠の記録参照ボタン追加
            --プロパティー「tyousasyoSyukketsuKirokuBtn」が'1'のとき表示

2017/09/06  1.日々出欠備考参照ボタンの切り替え条件を修正

2017/09/08  1.リファクタリング

2017/09/11  1.ADMIN_CONTROL_PRG_SCHOOLKIND_MSTを使って、校種を制御する。
            --プロパティー追加：use_prg_schoolkind
            2.更新時の処理修正(Chromeで動くように)

2017/09/26  1.通知表所見参照ボタン非表示、プロパティー「unUseSyokenSansyoButton」が"1"の時
            2.前回の修正、プロパティーを「unUseSyokenSansyoButton_H」に変更

2017/10/06  1.表彰参照ボタン追加、プロパティー「useHyosyoSansyoButton_H」が"1"の時表示
            2.前回の修正漏れ

2017/11/30  1.委員会取込ボタン、部活動取込ボタンカット
            2.参照ボタンを選択ボタンに変更
            -- 委員会、部活動、記録備考、検定、賞
            -- 選択したデータ、項目の取込機能追加
            3.部活動選択ボタンを特別活動所見欄に追加

2018/02/28  1.帳票用のプロパティー追加

2018/03/08  1.賞選択画面の表示内容変更
            -- 常盤木のとき、活動の記録(4)を表示

2018/03/09  1.検定選択画面でSUBCLASS_QUALIFIED_TEST_DATのデータも表示
            -- プロパティー「useQualifiedMst」かつプロパティー「useSchregQualified」が'SUBCLASS_QUALIFIED_TEST_DAT'の時

2018/03/29  1.項目「キャリアプラン」の切り替えはログイン年度を参照するよう修正

2018/04/04  1.帳票へのパラメータseitoSidoYoroku_dat_TotalremarkSize追加
            2.帳票へのパラメータseitoSidoYoroku_dat_Attendrec_RemarkSize追加

2018/04/26  1.近大の場合は３年生の時「通知票取込」→「総合的な学習の時間より読込」に変更

2018/05/24  1.帳票へのパラメータseitoSidoYorokuTotalStudyCombineHtrainremarkDat追加

2018/05/25  1.更新時は更新ボタンを押下できないよう修正した

2018/06/07  1.プロパティーseitoSidoYorokuHoushiNentaniが2の場合、奉仕の記録はHTRAINREMARK_HDAT.TOTALSTUDYACT2、TOTALSTUDYVAL2を使用する

2018/09/03  1.帳票へのパラメータseitoSidoYorokuFieldSize追加

2018/10/16  1.部活動複数校種設定対応
            -- プロパティー「useClubMultiSchoolKind」参照

2018/11/05  1.条件を「3年生のとき」→「卒業可能学年のとき」に変更
            -- 調査書より読込ボタンの表示
            -- 総合的な学習の時間の記録の通知票取込ボタンと調査書取込ボタンの切替

2018/12/26  1.共通プログラムに変更
            -- 委員会選択、賞選択、部活動選択、記録備考選択、検定選択

2019/02/18  1.高校指導要録所見入力の特別活動所見欄の部活動選択ボタン表示を
              useKnja120_clubselect_Buttonプロパティ(1の時に非表示)で制御するよう、変更
            -- プロパティー「useKnja120_clubselect_Button」追加

2019/02/19  1.useKnja120_clubselect_Buttonプロパティ制御を、プロパティ1の時にボタン表示するよう、変更

2019/02/25  1.2018年度以降入学生は、総合所見を表示のみ、KNJE015コールボタン表示
            2.高校以外は更新対象外。
            3.調査書より読込で、2018年度以降入学生の場合。総合所見は読み込まない

2019/02/28  1.useKnja120_clubselect_Buttonプロパティ制御を、プロパティ1の時にボタン非表示するよう、変更
            2.tutisyoSougoushokengakkiプロパティで対象学期を指定可能にするよう変更
               -- tutisyoSougoushokengakki = 1    → 従来通り9学期
               -- tutisyoSougoushokengakki = 1-23 → 2学期と3学期

2019/03/14  1.総合所見の使用不可条件に ENT_DIVが "1","2","3" の場合を追加
            2.画面遷移時は、保存されないメッセージを出す

2019/03/15  1.総合所見の使用不可条件を以下のように変更
              2018年度 1学年:使用不可、2学年:使用可、3学年:使用可
              2019年度 1学年:使用不可、2学年:使用不可、3学年:使用可
              2020年度 全学年使用不可

2019/03/18  1.データ更新時、画面のロックを追加

2019/03/19  1.名称マスタ「Z010」narakenの時、奈良Time欄を追加

2019/03/25  1.2019/03/15の修正間違いを修正。(入学年度 → 指定年度)
            2.useSeitoSidoYorokuShomeiKinou=1の場合、平成30年度入学者仕様の対象外

2019/04/09  1.奈良Timeの修正

2019/07/02  1.プロパティ「useSeitoSidoYorokuSougouShoken」追加
    　　　  プロパティが0の時、総合所見入力可能。
    　　　  プロパティが1の時、総合所見入力不可。

2019/07/04  1.「年間出欠備考選択」ボタンを追加
            -- プロパティー「useReasonCollectionBtn」が'1'のとき表示

2019/08/01  1. SQL修正

2019/08/02  1.useSeitoSidoYorokuShomeiKinou=1の場合は平成30年度入学者仕様の対象外（所見入力可、平成30年度以降入学者ボタン非表示）に修正

2019/08/14  1.奈良Timeの文字数を25文字10行に変更

2019/08/22  1.左画面の校種コンボ用パラメーター追加(URL_SCHOOLKIND)

2019/09/19  1.「出欠の記録参照」は「KNJX_SYUKKETSUKIROKU」を呼び出すよう修正

2019/10/04  1.ログイン年度がプロパティseitoSidoYorokuNoValidateShokenSizeEndYear以下なら所見のサイズチェックしない

2019/10/29  1.「調査書内容選択」ボタンを追加し、選択した調査書の文言のみを反映させる機能を追加
            2.プロパティー「useKnja120a_TyousasyoSentaku_Button」を追加
             -- プロパティが"1"のとき、調査書を参照できる対象を全学年（名称マスタ「A023」 NAME2～NAME3の学年）とする
             -- プロパティが"1"のとき、「調査書内容選択」ボタンを表示対象とし、「調査書より読込」ボタンは非表示
            3.定型文入力機能を追加

2020/01/24  1.項目名「総合的な学習の時間の記録」を、2019年度の1年生以降の生徒の場合は「総合的な探究の時間の記録」と
              表示するよう、変更

2020/02/04  1.総合所見の「定型文選択」ボタンを追加
            -- プロパティー「seitoSidoYorokuSougou_Teikei_Button_Hyouji」が'1'のとき表示

2020/02/13  1.通知表所見参照画面で文言が折り返されない不具合修正

2020/02/18  1.定型文入力画面修正に伴う修正

2020/03/10  1.以下のプロパティを参照し定型選択ボタンを表示するよう修正
            -- プロパティー「TotalRemark_HTRAINREMARK_TEMP_DAT」追加。'0'以外の時、値に対応する定型文を取得 ：指導要録、調査書の総合所見1・2
            -- プロパティー「SpecialAct_HTRAINREMARK_TEMP_DAT」追加。'0'以外の時、値に対応する定型文を取得  ：指導要録、調査書の特別活動1・2

2020/03/11  1.「TotalRemark_HTRAINREMARK_TEMP_DAT」が'1'の時、定型文ボタンを表示するよう修正(定型文は「DATA_DIV=12」「DATA_DIV=13」を取得)
            2.「SpecialAct_HTRAINREMARK_TEMP_DAT」が'1'の時、定型文ボタンを表示するよう修正(定型文は「DATA_DIV=14」「DATA_DIV=15」を取得)

2020/03/12  1.プロパティ「useHEXAM_ENTREMARK_TRAINREF_DAT_Button_Hyouji」を追加
            --'1'の場合、「平成30年度以降入学者　入力プログラムへ」ボタン表示（処理は現状通り）
            --'0'の場合、「平成30年度以降入学者　入力プログラムへ」ボタンは表示しない

2020/03/27  1.「平成30年度以降入学者　入力プログラムへ」ボタンを表示しないよう修正

2020/04/07  1.パラメータDOCUMENTROOT追加

2020/07/21  1.「中学で履修済みの備考」を追加
            2.「罰選択」ボタン追加
            3.「中学で履修済みの備考」の登録先を変更

2020/07/30  1.駒沢の場合、「マラソン大会選択」「臘八摂心皆勤」ボタンを追加

2020/09/10  1.調査書取込(6分割)の処理を追加

2020/09/11  1.以下の修正をした
            --調査書選択の子画面の表示サイズ修正
            --調査書取込の抽出条件を修正

2021/02/15  1.「中学で履修済み備考」を年間毎ではなく通年での登録に変更

2021/03/11  1.「中学で履修済み備考」の入力枠の横幅を変更

2021/04/05  1.城東は総合所見3分割で入力する。調査書から取込む。

2021/04/06  1.城東は2020年度3年生から総合所見6分割で入力する。調査書から取込む。

2021/04/07  1.城東高校は総合所見の6分割の1行の文字数を16に変更

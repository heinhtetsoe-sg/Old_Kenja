/*** KNJA110A 学籍基礎データ入力（担任）賢者版 ***/
$Id: 9d1adaef4d6fe33bc2218dd6d502916f1a037acf $

2009/07/16  1.PHP5に対応

2010/03/31  1.保護者情報の履歴を取るよう修正
            2.新規追加時のエラー修正
            3.チェックボックスの場所の修正
            4.続柄にアスタリスク追記
            5.何も選択せず追加を押した時のエラーを修正
            6.送信する直前に「disabled」をはずすよう修正(値をサーバーに送るため)
            7.dbエラー修正
            8.dbエラー修正
            9.日付の入力範囲の修正
            10.続柄のアスタリスクをカット
            11.いろいろ修正

2010/04/13  1.履歴修正処理追加

2010/04/21  1.コピー押下で日付も追加

2010/04/23  1.有効期間の文言変更

2010/05/11  1.履歴処理修正

2010/05/25  1.チェック処理修正

2010/07/21  1.保護者データの住所関係は、住所履歴のMAX日付のデータで上書きする。

2010/08/03  1.肩書き出力可フラグ追加
            -- rep-guardian_address_dat_rev1.4.sql
            -- rep-schreg_address_dat_rev1.8.sql
            2.上段の履歴にも、肩書き出力可を表示する。

2010/08/13  1.「GUARDIAN_DAT」「GUARDIAN_HIST_DAT」に戸籍名追加に伴う修正
            2.「保護者履歴修正」画面のテーブルのヘッダー修正

2011/06/28  1.重複チェックの追加

2011/08/09  1.生徒の住所データ登録するのに、保護者の住所データもチェックしていた部分を修正
              - 電話番号、FAX番号、E-Mail、勤務先電話番号 部分

2011/08/24  1.保護者履歴修正ボタンを押した時に表示される文字化けを修正

2012/04.24  1.AREACDがnullの時の仕様統一（KNJX030,KNJA040,KNJA110A）
                - AREACDがnullの時、'00'をセット

2013/01/31  1.保護者住所の削除時のチェック処理の不具合を修正

2013/07/22  1.保護者履歴修正画面のヘッダー部分に対象データの学籍番号と生徒名を表示

2013/12/07  1.住所のサイズ変更等に伴う修正
            -- rep-guardian_address_dat_rev1.5.sql
            -- rep-schreg_address_dat_rev1.9.sql
            -- rep-schreg_base_mst_rev1.9.sql

2013/12/11  1.住所のサイズ変更等に伴う修正

2014/09/02  1.”住”に保護者情報２の追加
            -- [上画面]
            -- ラジオボタンに「保護者情報２」の追加
            -- [下画面]
            -- 左表に「保護者情報２よりコピー」ボタンの追加
            -- 右表に「保護者情報２よりコピー」または「保護者情報よりコピー」ボタンの追加
            ※ プロパティ（useGuardian2 = 1）の時、表示する
            ※ 関連スクリプト
            -- guardian2_address_dat_rev1.1.sql
            -- guardian2_dat_rev1.1.sql
            -- guardian2_hist_dat_rev1.1.sql

2014/09/08  1.「XXXよりコピー」ボタン押し下げ時、日付の区切りが'-'になる不具合修正
            2.保護者履歴修正画面の上表で、日付の区切りが'-'になる不具合修正
            3.前々回修正(1番)の不具合修正

2014/10/08  1.以下の通り、ＤＢエラー(桁数オーバー)となる不具合修正
            -- [住]を選択して、生徒の急用連絡先を入力(桁数オーバーの入力)
            -- [更新]するとＤＢエラー(桁数オーバー)となる不具合修正
            ※ メニュー起動後、最初の１回のみ発生

2015/06/12  1.氏名等履歴の予約機能追加

2016/06/30  1.編集対象に保証人情報、その他情報追加
            2.保証人履歴修正画面追加
            3.保護者履歴修正画面のチェック変更時の背景色変更

2016/07/29  1.編集対象ラジオに家族情報追加

2016/08/02  1.兄弟姉妹検索の不具合修正
            2.兄弟姉妹検索の保護者１・２の電話番号の参照テーブル修正

2016/08/03  1.プロパティuseGuardian2='1'の時、兄弟姉妹検索の保護者２の電話番号を表示

2016/09/05  1.兄弟姉妹検索について、保護者電話番号項目を１つにし、検索対象は、
            -- 保護者１、保護者２、急用連絡先１、急用連絡先２の電話番号とする。

2016/10/01  1.家族情報の履歴欄で兄弟姉妹が卒業していたら学籍番号の横に卒業区分を表示
            2.生徒情報に「兄弟姉妹へコピー」ボタン追加

2016/12/26  1.その他情報の区分に下宿保証人追加

2016/12/28  1.生徒、保護者、保護者２に電話番号２を追加
            2.家族情報に在卒区分、学年追加
            3.保護者の勤務先電話番号の更新チェックの不具合修正

2017/03/17  1.家族情報の、在卒区分と同居区分コンボの入れ替わりを修正

2017/03/22  1.家族情報で兄弟検索時に、反映ボタンで親画面に氏名等の情報を表示

2017/03/24  1.家族情報テーブル新規作成に伴う修正
            -- プロパティー：useFamilyDat
            -- family_dat.sql(rev1.1)

2017/04/04  1.家族情報画面で以下の修正
            --文言修正、画面上方にある(兄弟姉妹検索→家族番号検索)、確定ボタン追加
            --検索画面で家族番号追加

2017/04/05  1.家族情報画面の文言修正
            2.家族番号検索のデータ有無の判断を修正

2017/04/06  1.家族情報の、家族検索画面で家族番号が無い時は空白を挿入
            2.家族情報検索更新機能修正(FAMILY_NO 8桁 → 9桁)
            -- family_dat.sql(rev1.2)

2017/04/17  1.家族情報の、家族番号検索画面で学年が表示されない不具合を修正

2017/05/18  1.他画面からコール時に受け取るパラメーター追加。(更新処理使用不可)

2017/05/19  1.互換での表示が崩れるのを修正

2017/07/03  1.家族情報の家族番号検索画面で反映/更新をするとDBエラーになる不具合を修正

2017/12/08  1.生徒情報画面を修正
            -- 急用連絡先に電話番号2を追加
            -- 急用連絡先の電話番号の横にメモテキストボックス追加
            -- 電話番号の優先順位テキストボックス追加

2017/12/18  1.備忘録追加(SCHREG_BASE_DETAIL_MST(009:REMARK2))

2018/01/16  1.生徒情報の削除処理で、SCHREG_ADDRESS_DATが1件もないときの処理を追加
            -- SCHREG_BASE_MSTの緊急連絡先をクリア
            -- SCHREG_BASE_DETAIL_MSTのBASE_SEQが'012','013'を削除

2018/07/17  1.生徒情報画面を修正
            -- 電話番号、電話番号2の横にメモテキストボックス追加
            -- rep-schreg_address_dat.sql(rev.61301)

2019/12/27  1.プロパティーsearch_zipcd_set_town_to_addr2が1の場合、郵便番号入力支援は住所に都道府県名と市区町村名、方書に町域名をセットする

2020/03/17  1.保護者履歴の「有効期間終了」に「9999/12/31」がある場合、保護者履歴の登録を行えないよう修正

2020/03/18  1.「有効期間終了」をシステム日付より未来日を指定した場合、過去の保護者履歴まで更新される不具合修正

2020/03/19  1.保護者履歴の「保護者氏名」「保護者氏名かな」の必須チェックを行わないよう修正

2020/11/12  1.プロパティー「NAME_INPUT_SIZE」に値が設定されている時、氏名、戸籍氏名、緊急連絡先氏名1/2の入力文字数がこのプロパティ値以下かチェックするよう、変更
              ※未設定時は既存値。
            2.プロパティー「chkNameInputHankaku」= 1の時、氏名、戸籍氏名、緊急連絡先氏名1/2に半角文字が混ざっていないか、チェックするよう、変更
            3.プロパティー「chkAddrInputHankaku」= 1の時、住所(方書き)、保護者住所(方書き)、保証人住所(方書き)、その他住所(方書き)に半角文字が混ざっていないか、チェックするよう、変更
            -- プロパティー「NAME_INPUT_SIZE」追加
            -- プロパティー「chkNameInputHankaku」追加
            -- プロパティー「chkAddrInputHankaku」追加

2020/11/16  1.プロパティー「PublicOffice_TitleNameSettei」= 1の時、保証人等の勤務先タイトル名称を「就業先」、初期値を「兼ねている公職」に設定

2020/12/02  1.リファクタリング
            2.プロパティー「ADDR_INPUT_SIZE」に値が設定されている時、住所(方書き)、保護者住所(方書き)、保証人住所(方書き)、その他住所(方書き)の
              入力文字数がこのプロパティ値以下かチェックするよう、変更
              -- プロパティー「ADDR_INPUT_SIZE」追加
